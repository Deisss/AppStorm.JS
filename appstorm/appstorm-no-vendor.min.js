window.appstorm=window.a=function(){var c={url:"",contains:function(b,c){if(b instanceof Array)for(var f=b.length;f--;){if(b[f]===c)return!0}else if(this.isObject(b))return c in b;return!1},clone:function(b){if(a.isObject(b)){if(a.isArray(b))for(var c=b.length,f=Array(c),g=0;g<c;++g)f[g]=a.clone(b[g]);else for(c in f={},a.isFunction(b.constructor)&&(f=new b.constructor),a.isObject(b.prototype)&&(f.prototype=b.prototype),b)f[c]=a.clone(b[c]);return f}return b},isNumber:function(b){return!isNaN(parseFloat(b))&&
isFinite(b)},isObject:function(b){return"object"===typeof b&&null!==b},isString:function(b){return"string"===typeof b},isFunction:function(b){return"function"===typeof b},isNull:function(b){return"undefined"===typeof b||null===b},isBoolean:function(b){return"boolean"===typeof b},isArray:function(b){return b instanceof Array}},b=document.getElementById("a-core");b&&"undefined"!==typeof b.src&&(c.url=b.src.replace(/\/[^/]*$/,"/"));return c}();
a.console=function(){function c(c,e,f,g){a.isArray(b[c])||(c="log");b[c].push(e);if(!a.isNull(window.console)&&a.isFunction(window.console.log)&&!1!==g)switch(a.environment.get("console")){case "error":if("error"!==c)break;case "warning":case "warn":if("warn"!==c&&"error"!==c)break;case "info":if("log"===c)break;default:g=!0;var h=!1;if(a.isString(e)&&0<=e.indexOf(":"))for(var k=e.substr(0,e.indexOf(":")).split("."),l=k.length;l--;){var u="verbose-"+k.join("."),u=a.environment.get(u);if(!a.isNull(u)){h=
!0;g=u<f?!1:!0;break}k.pop()}h||(a.isNull(a.environment.get("verbose"))||a.isNull(f))||parseInt(a.environment.get("verbose"),10)<f&&(g=!1);if(g)window.console[c](e)}for(;2E3<b[c].length;)b[c].shift()}var b={log:[],warn:[],info:[],error:[]};return{log:function(b,e,f){c("log",b,e,f)},warn:function(b,e,f){c("warn",b,e,f)},info:function(b,e,f){c("info",b,e,f)},error:function(b,e,f){c("error",b,e,f)},trace:function(c){return a.isString(c)&&c in b?b[c]:b},clear:function(){b={log:[],warn:[],info:[],error:[]}}}}();
a.parser={json:{stringify:function(c){try{return JSON.stringify(c)}catch(b){return a.console.error("a.parser.json.stringify : unable to stringify the value : "+c,1),""}},parse:function(c){try{return JSON.parse(c)}catch(b){return a.console.error("a.parser.json.parse : unable to parse the value : "+c,1),null}}},xml:{stringify:function(c){if(!a.isNull(c)&&!a.isNull(c.xml))return c.xml;if(!a.isNull(window.XMLSerializer))try{return(new window.XMLSerializer).serializeToString(c)}catch(b){return a.console.error("a.parser.xml.stringify : unable to stringify the value : "+
c,1),""}a.console.error("a.parser.xml.stringify : unable to find any parser available",1);return""},parse:function(c){if(!a.isNull(window.ActiveXObject)){for(var b=null,d=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0"],e=0,f=d.length;e<f;++e)try{b=new ActiveXObject(d[e])}catch(g){}b.async=!1;b.loadXML(c);return 0!=b.parseError.errorCode?(a.console.error("a.parser.xml.parse : error while parsing content : "+b.parseError.reason,1),null):b}if(!a.isNull(window.DOMParser))return(new DOMParser).parseFromString(c,
"text/xml");a.console.error("a.parser.xml.parse : unable to find any parser available",1);return null}}};
a.eventEmitter=function(){function c(c){for(var e in b.__list)1>b.__list[e].length&&delete b.__list[e]}var b=function(){this.__list={};this.__base="a.message"};b.prototype.setName=function(b){this.__base=""+b};b.prototype.addListener=function(b,c){a.isFunction(c)?(a.isNull(this.__list[b])&&(this.__list[b]=[]),this.__list[b].push(c),this.dispatch(this.__base+".add",{type:b,fct:c})):a.console.warn(this.__base+".addListener : unable to bind function, this is not a function",1)};b.prototype.removeListener=
function(b,e){if(!a.isNull(this.__list[b])){var f=this.__list[b].length;if(a.isFunction(e))for(;f--;)this.__list[b][f]===e&&this.__list[b].splice(f,1);this.dispatch(this.__base+".remove",{type:b,fct:e});c(b)}};b.prototype.removeAllListeners=function(b){a.isNull(this.__list[b])||(this.__list[b]=[],c(b))};b.prototype.clear=function(){var b=this.__base+".clear",c;for(c in this.__list)c!==b&&delete this.__list[c];this.dispatch(b,{})};b.prototype.dispatch=function(b,c){var f=this.__list[b];if(!a.isNull(f))for(var g=
0,h=f.length;g<h;++g)(function(b){setTimeout(function(){b(c)},0)})(f[g])};return b}();a.message=new a.eventEmitter;a.message.setName=function(){};
a.environment=function(){var c={verbose:2,console:"log"};return{get:function(b){return b in c?c[b]:null},set:function(b,d){a.isNull(b)||(a.console.log("a.environment.set: add item (key: "+b+", value: "+d+")",3),c[b]=d,a.message.dispatch("a.environment.add",{key:b,value:d}))},remove:function(b){a.isNull(c[b])||(a.console.log("a.environment.remove: remove item (key: "+b+")",3),delete c[b],a.message.dispatch("a.environment.remove",{key:b}))},clear:function(){c={verbose:2,console:"log"}}}}();
a.ajax=function(c,b,d){this.params={url:"",method:"GET",type:"raw",async:!0,cache:!1,data:{},header:{}};this.success=a.isFunction(b)?b:function(){};this.error=a.isFunction(d)?d:function(){};for(var e in this.params)e in c&&typeof c[e]===typeof this.params[e]&&(this.params[e]=c[e]);a.isString(c.data)&&(this.params.data=c.data);this.request=null;if(a.isNull(window.XMLHttpRequest)){c=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(var f in c)try{this.request=new ActiveXObject(c[f])}catch(g){}}else this.request=
new XMLHttpRequest};a.ajax.prototype.parseResult=function(c,b){var d=c.type.toLowerCase();return"json"===d?a.parser.json.parse(b.responseText):"xml"===d?b.responseXML:b.responseText};a.ajax.prototype.abort=function(){try{this.request.abort()}catch(c){}};
a.ajax.prototype.send=function(){var c=this.params.method.toUpperCase();if(!1===this.params.cache){var b=Math.floor(1E5*Math.random())+1;try{this.params.data.cachedisable=b}catch(d){}}b="";if(a.isString(this.params.data))b=this.params.data;else{for(var e in this.params.data)b+=encodeURIComponent(e)+"="+encodeURIComponent(this.params.data[e])+"&";b=b.slice(0,-1)}var f=this.params.url;e=this.params.async;"GET"===c&&""!==b&&(f+="?"+b);if(!0===e){var g={success:this.success,params:this.params,error:this.error,
request:this.request,parseResult:this.parseResult};this.request.onreadystatechange=function(){if(4===g.request.readyState){var b=200<=g.request.status&&300>g.request.status;b?g.success(g.parseResult(g.params,g.request),g.request.status):g.error(f,g.request.status);a.message.dispatch("a.ajax",{success:b,status:g.request.status,url:g.params.url,method:g.method,params:g.params})}}}this.request.open(c,f,e);"POST"===c&&this.request.setRequestHeader("Content-type","application/x-www-form-urlencoded");for(var h in this.params.header)this.request.setRequestHeader(h,
this.params.header[h]);this.request.send(b);return!1===e?this.parseResult(this.params,this.request):"No return in async mode"};
a.timer=function(){var c={};setInterval(function(){a.message.dispatch("a.timer.tick",{});for(var b in c){var d=c[b];d.current+=50;if(d.current>=d.timeout&&(d.current=0,a.isFunction(d.fct))){var e=a.isObject(d.scope)?d.scope:null;d.fct.call(e,null)}}},50);return{add:function(b,d,e){var f;for(f=Math.floor(1E6*Math.random());!a.isNull(c[f]);)f=Math.floor(1E6*Math.random());if(!a.isNumber(e)||0>=e)e=1E3,a.console.error("The timeout has not been setted properly into timer, timeout has been setted to 1000ms",
1);c[f]={fct:b,scope:d,timeout:e,current:0};return f},once:function(b,c,e){var f=this.add(function(){a.isFunction(b)&&b.call(this,null);a.timer.remove(f)},c,e);return f},get:function(b){b=c[b];return a.isNull(b)?null:b},remove:function(b){return a.isNull(c[b])?!1:(delete c[b],!0)},clear:function(){c={}}}}();
a.loader=function(){function c(b,c){if(a.isNull(b))return!1;for(var d=0,f=e.length;d<f;++d)if(e[d]===b)return a.isFunction(c)&&c(),!0;return!1}function b(b,c,d,g,p,m){for(var s in c)b.setAttribute(s,c[s]);!a.isNull(p)&&p.id&&b.setAttribute("id",p.id);var n=!1,t=function(c){n||(n=!0,a.isFunction(d)&&d(b),(a.isNull(p)||!1!==p.cache)&&e.push(g))};b.addEventListener?b.addEventListener("load",t,!1):b.readyState?b.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||t()}:
b.onload=t;if("text/css"===c.type){var x=document.styleSheets.length;f++;var v=a.timer.add(function(){document.styleSheets.length>x+f-1&&(f--,a.timer.remove(v),t())},null,50)}document.getElementsByTagName("head")[0].appendChild(b)}function d(b,c,d,f){var p={url:b,method:"GET",type:"raw",async:!0,cache:!0,data:{},header:{}};a.console.log("a.loader: load resource (url: "+b+")",3);a.isNull(d)||(a.contains(g,d.method)&&(p.method=d.method),a.isNull(d.type)||"json"!==d.type&&"xml"!==d.type||(p.type=d.type),
a.isObject(d.data)&&(p.data=d.data),a.isObject(d.header)&&(p.header=d.header),a.isBoolean(d.cache)&&(p.cache=d.cache));f=a.isFunction(f)?f:function(){};(new a.ajax(p,function(f,g){a.isFunction(c)&&c(f,g);(a.isNull(d)||!1!==d.cache)&&e.push(b)},f)).send()}var e=[],f=0,g="GET POST PUT DELETE HEAD OPTIONS".split(" ");return{js:function(b,d,e,f){c(b,d)||this.jsonp(b,d,e,f)},jsonp:function(c,d,e,f){var g=a.isObject(e)&&e.type?e.type:"text/javascript";a.console.log("a.loader: load resource (url: "+c+")",
3);b(document.createElement("script"),{type:g,src:c},d,c,e,f)},json:function(b,c,e,f){a.isObject(e)||(e={});e.type="json";a.isObject(e.header)||(e.header={});e.header.accept="application/json, text/javascript";d(b,c,e,f)},xml:function(b,c,e,f){a.isObject(e)||(e={});e.type="xml";a.isObject(e.header)||(e.header={});e.header.accept="application/xml, text/xml";d(b,c,e,f)},css:function(e,d,f,g){c(e,d)||(a.console.log("a.loader: load resource (url: "+e+")",3),b(document.createElement("link"),{rel:"stylesheet",
type:"text/css",href:e},d,e,f,g))},html:function(b,e,f,g){c(b,e)||(a.isObject(f)||(f={}),f.type="raw",!0===a.environment.get("debug")&&(f.cache=!1),a.isObject(f.header)||(f.header={}),f.header.accept="text/html",d(b,e,f,g))},javafx:function(b,e,d,f){if(a.isNull(d)||a.isNull(d.code)||a.isNull(d.id))a.console.warn("a.loader.javafx : the system need args.code and args.name setted to be able to load any javafx resource... This uri will not be loaded : "+b,3);else if(!c(b,e)){this.js("http://dl.javafx.com/"+
(d.version?d.version:"1.3")+"/dtfx.js",function(){javafx({archive:b,width:d.width||1,height:d.height||1,code:d.code,name:d.id})});var g=null,m=2E3,g=a.timer.add(function(){0<m--&&!a.isNull(document.getElementById(d.id).Packages)?(a.timer.remove(g),a.isFunction(e)&&e()):0>=m&&a.isFunction(f)&&f(b,408)},null,200)}},flash:function(b,e,d,f){a.isNull(d)||a.isNull(d.rootId)||a.isNull(d.id)?a.console.warn("a.loader.flash : the system need args parameters : rootId, id, setted to be able to load any flash resource... This uri will not be loaded : "+
b,3):c(b,e)||this.js(a.url+"vendor/storage/flash/swfobject.js",function(){swfobject.embedSWF(b,d.rootId,"100%","100%","10.0.0",a.url+"vendor/storage/flash/expressInstall.swf",d.flashvars,d.params,{id:d.id},function(c){!1===c.success&&a.isFunction(f)?f(b,408):!0===c.success&&a.isFunction(e)&&setTimeout(e,500)})})},silverlight:function(b,d,e,f){if(a.isNull(e)||a.isNull(e.rootId)||a.isNull(e.id))a.console.warn("a.loader.silverlight : the system need args parameters : rootId, id, setted to be able to load any silverlight resource... This uri will not be loaded : "+
b,3);else if(!c(b,d)){a.console.log("a.loader: load resource (url: "+b+")",3);var g=document.createElement("object");g.id=e.id;g.data="data:application/x-silverlight-2,";g.type="application/x-silverlight-2";a.isArray(e.params)||(e.params=[]);e.params.push({name:"source",value:b});for(var m=0,s=e.params.length;m<s;++m){var n=document.createElement("param");n.name=e.params[m].name;n.value=e.params[m].value;g.appendChild(n)}document.getElementById(e.rootId).appendChild(g);var t=null,x=2E3,t=a.timer.add(function(){0<
x--&&!a.isNull(document.getElementById(e.id).Content)?(a.timer.remove(t),d()):0>=x&&a.isFunction(f)&&f(b,408)},null,200)}},trace:function(){return e}}}();a.callback={};
a.callback.synchronizer=function(){function c(){k--;0>=k&&!1===m?(p=!1,n.prototype.dispatch("a.callback.synchronizer.success",{}),l(s)):0>=k&&(p=m=!1)}function b(){!0===p&&(m=!0,p=!1,n.prototype.dispatch("a.callback.synchronizer.error",{}),u.apply(this,arguments))}function d(b,c){s[b]=c}function e(b){a.isObject(b)&&(s=b)}function f(b){return a.isNull(s[b])?null:s[b]}function g(){return s}var h=[],k=0,l=function(){return!0},u=function(){return!0},p=!1,m=!1,s={},n=function(){};n.prototype=new a.eventEmitter;
n.prototype.constructor=this;n.prototype.setSuccess=function(b){l=a.isFunction(b)?b:l};n.prototype.setDone=n.prototype.setSuccess;n.prototype.setFail=function(b){u=a.isFunction(b)?b:u};n.prototype.setError=n.prototype.setFail;n.prototype.addCallback=function(){for(var x=[],x=!a.isNull(arguments[0])&&a.isArray(arguments[0])?arguments[0]:arguments,v=0,w=x.length;v<w;++v){var r=x[v];a.isFunction(r)&&(k++,h.push(r),!0===p&&r({success:c,done:c,getData:f,getFullData:g,setData:d,setFullData:e,fail:b,error:b}))}!0===
p&&a.console.warn("a.callback.synchronizer.addCallback : you should not add/remove callback when synchronizer is running",1)};n.prototype.removeCallback=function(b){for(var c=h.length-1;0<=c;--c)h[c]===b&&(!0===p&&a.console.warn("a.callback.synchronizer.removeCallback : you should not add/remove callback when synchronizer is running",1),k--,h.splice(c,1))};n.prototype.start=function(x,v){if(0>=k)c();else{p=!0;s={};for(var w=0,r=h.length;w<r;++w)h[w]({success:c,done:c,getData:f,getFullData:g,setData:d,
setFullData:e,fail:b,error:b},v);a.isNumber(x)&&0<x?setTimeout(function(){var c=parseInt(x,10);n.prototype.dispatch("a.callback.synchronizer.error",{timeout:c});b({timeout:c})},x):n.prototype.dispatch("a.callback.synchronizer.start",{timeout:-1})}};n.prototype.isRunning=function(){return p};var t=new n;t.setName("a.callback.synchronizer");return t};
a.callback.chainer=function(){function c(){0==u.length?(u=[],k(p),m.prototype.dispatch("a.callback.chainer.success",{})):m.prototype.start(arguments)}function b(){u=[];l.apply(this,arguments);m.prototype.dispatch("a.callback.chainer.error",{})}function d(b,c){p[b]=c}function e(b){a.isObject(b)&&(p=b)}function f(b){return a.isNull(p[b])?null:p[b]}function g(){return p}var h=[],k=function(){return!0},l=function(){return!0},u=[],p={},m=function(){};m.prototype=new a.eventEmitter;m.prototype.constructor=
this;m.prototype.setSuccess=function(b){k=a.isFunction(b)?b:k};m.prototype.setDone=m.prototype.setSuccess;m.prototype.setFail=function(b){l=a.isFunction(b)?b:l};m.prototype.setError=m.prototype.setFail;m.prototype.addCallback=function(){for(var b=[],b=!a.isNull(arguments[0])&&a.isArray(arguments[0])?arguments[0]:arguments,c=0,e=b.length;c<e;++c){var d=b[c];a.isFunction(d)&&(h.push(d),!0===m.prototype.isRunning()&&u.push(d))}!0===m.prototype.isRunning()&&a.console.warn("a.synchronizer.addCallback : you should not add/remove callback when synchronizer is running",
1)};m.prototype.removeCallback=function(b){for(var c=h.length-1;0<=c;--c)if(h[c]===b){if(!0===m.prototype.isRunning()){for(var e=u.length-1;0<=e;--e)u[e]===b&&u.splice(e,1);a.console.warn("a.synchronizer.removeCallback : you should not add/remove callback when synchronizer is running",1)}h.splice(c,1)}};m.prototype.start=function(){if(0==u.length){for(var k=0,s=h.length;k<s;++k)u.push(h[k]);m.prototype.dispatch("a.callback.chainer.start",{});p={};0==u.length&&c()}k=u.shift();a.isFunction(k)&&k({success:c,
done:c,getData:f,getFullData:g,setData:d,setFullData:e,fail:b,error:b},arguments)};m.prototype.isRunning=function(){return 0==u.length?!1:!0};var s=new m;s.setName("a.callback.chainer");return s};a.form=function(){function c(b,c){return a.isNull(b.getAttribute)?null:b.getAttribute(c)}function b(b){for(var c=[],e=b.length;e--;)c.push(b[e]);return c}function d(b){var e=c(b,"name");if(a.isNull(e)||""===e)if(e=c(b,"id"),a.isNull(e)||""===e)e=c(b,"class");return e}function e(e){var d=e.getElementsByTagName("input"),f=e.getElementsByTagName("textarea");e=e.getElementsByTagName("select");for(var d=b(d),g=d.length;g--;)a.contains(l,c(d[g],"type"))||d.splice(g,1);return d.concat(b(f),b(e))}function f(b,
e,d,f){var g="";a.isNull(d)||""===d||(g=c(b,"data-error-"+d));if(a.isNull(g)||""===g)g=c(b,"data-error");(a.isNull(g)||""===g)&&a.console.warn("A data-error tag has not been setted for "+e+" with value "+f+", can't proceed error show",3);a.isNull(a.language)||(g=a.language.getSingleTranslation(g,{name:d,value:f}));return{el:b,id:e,error:g}}var g="text search url tel email password".split(" "),h="number range date datetime datetime-local month time week".split(" "),k=g.concat(h,["number","checkbox",
"radio","file"]),l=h.concat(g,["color","checkbox","file","hidden","radio"]);return{skipNoValidate:!1,get:function(b){b=e(b);for(var f={},g=b.length;g--;){var h=b[g],k=d(h),l;l=h;var x=c(l,"type"),v=l.tagName.toLowerCase();l="input"===v||"textarea"===v?"checkbox"===x?l.checked:l.value:"select"===v?l.options[l.selectedIndex].value:void 0;null!==k&&""!==k&&(a.isNull(h)||"radio"!==c(h,"type")?f[k]=""===l?null:l:h.checked&&(f[k]=""===l?null:l))}a.console.log("a.form.get: found element list:",3);a.console.log(f,
3);return f},validate:function(b){if(!a.isNull(c(b,"novalidate"))&&!1===this.skipNoValidate)return[];b=e(b);for(var l=[],m="number range text search url email password color checkbox hidden radio".split(" "),s=RegExp("^[a-z]{2,}:\\/\\/([a-z0-9\\/\\.\\-_~+;:&=]{2,})$","gi"),n=RegExp("^.{2,}@.*\\.[a-z0-9]{2,}$","gi"),t=RegExp("^#([a-f]{3}|[a-f]{6})$","gi"),x=b.length;x--;){var v=b[x],w=v.tagName.toLowerCase();if("select"!==w&&a.isNull(c(v,"formnovalidate"))){var r=c(v,"type"),q=d(v),y=v.value,F=c(v,
"required"),D=c(v,"pattern");c(v,"multiple");var B=c(v,"min"),A=c(v,"max"),z=c(v,"step"),B=a.isNull(B)||""===B?null:parseFloat(B),A=a.isNull(A)||""===A?null:parseFloat(A),z=a.isNull(z)||""===z?null:parseFloat(z);"input"!==w||a.contains(m,r)?"number"!==r&&"range"!==r||a.isNumber(y)?"url"!==r||s.test(y)?"email"!==r||n.test(y)?"color"!==r||t.test(y)?null!==F&&a.contains(k,r)&&(""===y||a.isNull(y))?l.push(f(v,q,"required",y)):null===D||"textarea"!==w&&!a.contains(g,r)||RegExp(D).test(y)?null===B&&null==
A&&null==z||!a.contains(h,r)||(w=parseFloat(y),null!==B&&w<B?l.push(f(v,q,"min",y)):null!==A&&w>A?l.push(f(v,q,"max",y)):null!==z&&0!==w%z&&l.push(f(v,q,"step",y))):l.push(f(v,q,"pattern",y)):l.push(f(v,q,null,y)):l.push(f(v,q,null,y)):l.push(f(v,q,null,y)):l.push(f(v,q,null,y)):a.console.warn("Type "+r+" for input "+q+" not recognized or not supported",3)}}a.console.log("a.form.validate: found error list:",3);a.console.log(l,3);return l},validateAndGet:function(b){return{errorList:this.validate(b),
error:0<obj.errorList.length?!0:!1,contentList:this.get(b)}}}}();a.keyboard=function(c){return a.isNull(c)?(a.console.error("a.keyboard.global: error, Mousetrap is undefined, the plugin a.keyboard will not work",1),{addListener:function(){},removeListener:function(){},reset:function(){},clear:function(){}}):{addListener:function(b,d){a.console.log("a.keyboard.addListener: bind key: "+b,3);c.bind(b,d)},removeListener:function(b){a.console.log("a.keyboard.removeLister: remove listener on key: "+b,3);c.unbind(b)},reset:function(){a.console.log("a.keyboard.reset: clear all keys",
3);c.reset()},clear:function(){a.console.log("a.keyboard.clear: clear all keys",3);c.reset()}}}(window.Mousetrap);a.language=function(){function c(b,c){if(a.isNull(k[b]))return null;var e=k[b][c];if(a.isNull(e))a.console.info("a.language.__getRawTranslate: unable to find hash in dictionnary (value: "+c+", language: "+b+")",3);else return e;return null}function b(b){b=""+b;0>b.indexOf("{{")&&(b="{{"+b+"}}");b=b.replace("{{","\\{\\{");return b=b.replace("}}","\\}\\}")}function d(e,d){var f=c(g,e);if(!a.isNull(f)){var r=f;if(a.isArray(d))for(var q=0,h=d.length;q<h;++q)var l=b(q+1),l=RegExp(l,"gi"),r=r.replace(l,
d[q]);else for(q in d)l=b(q),l=RegExp(l,"gi"),r=r.replace(l,d[q]);if(0<=r.indexOf("{{")&&0<=r.indexOf("}}"))for(f=f.match(/\{\{[a-z0-9\-_]+\}\}/gi)||[],q=0,h=f.length;q<h;++q){var l=b(f[q]),k=f[q].replace("{{","").replace("}}",""),k=a.isNull(m[k])?null:m[k];a.isNull(k)||(l=RegExp(l,"gi"),r=r.replace(l,k))}return r=r.replace(/\{\{[a-z\-_0-9]+\}\}/gi,"")}return e}function e(b,c){a.isString(c)||(c=u);try{return b.getAttribute(c)}catch(e){return null}}function f(b){a.isNull(b)&&(b=document);var f=[];
a.isNull(e(b))||f.push(b);var w=[];b.querySelectorAll?(w=b.querySelectorAll("*["+u+"]"),0===w.length&&(w=b.querySelectorAll("*"))):w=b.getElementsByTagName("*");b=0;for(var r=w.length;b<r;++b)a.isNull(e(w[b]))||f.push(w[b]);w=0;for(b=f.length;w<b;++w){var q=f[w],r=e(q);if(!a.isNull(r)){var h=c(g,r),k={};a.isNull(h)&&(h=r);for(var h=h.match(/\{\{[a-z0-9\-_]+\}\}/gi)||[],s=0,n=h.length;s<n;++s){var t=h[s].replace("{{","").replace("}}",""),z=e(q,u+"-"+t);a.isNull(z)?(z="undefined"===m[t]?null:m[t],a.isNull(z)||
(k[t]=z)):k[t]=z}h=d(r,k);r=e(q,p);if(!a.isNull(r))try{q[r]=h}catch(G){}else if(q)if("INPUT"!==q.nodeName||"submit"!==q.type&&"reset"!==q.type)if("INPUT"===q.nodeName)try{q.placeholder=h}catch(H){}else if("FIELDSET"===q.nodeName)q.title=h;else if(!a.isNull(q.text)&&document.all)q.text=h;else if(a.isNull(q.childNodes))q.innerHTML=h;else if(r=q.childNodes.length,k=document.createTextNode(h),"leave"===l){for(h=!1;r--;)s=q.childNodes[r],3===s.nodeType&&(h||(q.insertBefore(k,s),h=!0),q.removeChild(s));
h||q.appendChild(k)}else{for(;r--;)q.removeChild(q.firstChild);q.appendChild(k)}else q.value=h}}}var g="en",h=["en","fr","de","sp"],k={},l="leave",u="data-tr",p="data-tr-attr",m={},s=!a.isNull(a.storage)&&!0===a.storage.persistent.support;if(s){var n=a.storage.persistent.getItem("a_language_store_language"),t=a.storage.persistent.getItem("a_language_store_allowed");a.isString(n)&&(g=n,f(document));a.isArray(t)&&(h=t)}return{setBehavior:function(b){l="erase"===b?"erase":"leave"},getBehavior:function(){return l},
getCurrent:function(){return g},setCurrent:function(b,c){!a.isString(b)||0>=b.length?a.console.error("a.language.setCurrent: setting a non-string lang, or empty string, as default language: "+b,1):(a.isNull(c)&&(c=!0),a.contains(h,b)||a.console.warn("a.language.setCurrent: unable to find language in available language list (value: "+b+", available: "+h.join(";")+")",2),g=b,a.isNull(k[g])&&(k[g]={}),a.console.log("a.language.setCurrent: set current language to "+g+", request update ? "+c,3),a.message.dispatch("a.language.change",
{value:g}),s&&a.storage.persistent.setItem("a_language_store_language",g),this.translate(document,c))},getAllowed:function(){return h},setAllowed:function(b){a.isString(b)&&(b=[b]);if(a.isArray(b)){h=b;var c=0;for(b=b.length;c<b;++c)a.isNull(k[c])&&(k[c]={});s&&(a.console.log("a.language.setAllowed: set allowed language to "+h,3),a.storage.persistent.setItem("a_language_store_allowed",h))}else a.console.error("a.language.setAllowed: the allowed language must be an Array (value: "+b+")",1)},getSingleTranslation:function(b,
c){return d(b,c)},addSingleTranslation:function(b,c,e,d){a.isNull(k[b])&&(a.console.warn("a.language.addSingleTranslation: be carefull, the language you submit does not seems to exist in dict (value: "+b+", dict: "+h.join(";")+")",1),k[b]={});k[b][c]=e;this.translate(document,d)},addTranslation:function(b,c,e){a.isNull(k[b])&&(k[b]={});for(var d in c)k[b][d]=c[d];this.translate(document,e)},getTranslation:function(b){return a.isString(b)?k[b]:k},translate:function(b,c){!1!==c&&f(b)},addVariable:function(b,
c){a.console.log("a.language.addVariable: add global variable (key: "+b+", value: "+c+")",3);m[b]=c},getVariable:function(b){return"undefined"===m[b]?null:m[b]},removeVariable:function(b){a.console.log("a.language.removeVariable: remove global variable (key: "+b+")",3);delete m[b]},clear:function(){k={}}}}();a.page={};
a.page.template={__tmpl:{},get:function(c,b,d,e){var f=null;a.isObject(window.Mustache)?f=window.Mustache:a.isObject(window.Handlebars)&&(f=window.Handlebars);if(null==f)a.console.error("a.page.template.get: unable to find Mustache.JS or Handlebars.JS ! Can't proceed",1);else{var g=c.replace(/[^a-zA-Z0-9\\-]/g,"_"),h="a_tmpl_"+g+"_a",k=function(b,c,e){a.isFunction(b)&&(a.isNull(f.to_html)?(c=f.compile(a.page.template.__tmpl[c]),b(c(e))):b(f.to_html(a.page.template.__tmpl[c],e)))};a.isString(this.__tmpl[h])?(a.console.log("a.page.template.get: loading "+
h+" from cache",3),k(d,h,b)):document.getElementById(h)?(this.__tmpl[h]||(a.console.log("a.page.template.get: loading "+h+" from inner html page",3),this.__tmpl[h]=document.getElementById(h).innerHTML),k(d,h,b)):document.getElementById(g)?(this.__tmpl[g]||(a.console.log("a.page.template.get: loading "+g+" from inner html page",3),this.__tmpl[g]=document.getElementById(g).innerHTML),k(d,g,b)):(a.console.log("a.page.template.get: loading "+c+" from external resource",3),a.loader.html(c,function(c,e,
f){a.page.template.__tmpl[h]||(a.page.template.__tmpl[h]=c);k(d,h,b)},{},e))}},htmlToDom:function(c){var b=document.createElement("div");b.innerHTML=c.replace(/^\s+|\s+$/g,"");c=b.childNodes;for(var b=[],d=0,e=c.length;d<e;++d){var f=c.item(d);!a.isObject(f)||"1"!==f.nodeType.toString()&&"3"!==f.nodeType.toString()||b.push(f)}return b},remove:function(c,b){for(;c.firstChild;)c.removeChild(c.firstChild);a.isFunction(b)&&b()},append:function(c,b,d){var e=this.htmlToDom(b);if(a.isObject(e))for(var f=
0,g=e.length;f<g;++f)c.appendChild(e[f]);a.isNull(a.language)||a.language.translate(c);a.isFunction(d)&&d(b)},replace:function(c,b,d){this.remove(c);this.append(c,b,d)}};
a.page.event=function(){function c(b,c){a.isObject(c)||(c={});return function(){a.message.dispatch("a.page.event."+b,c)}}function b(){var b=(new Date).getTime();b>h+2*g&&(a.console.log("a.page.event.hibernate: hibernate mode has been detected",3),c("hibernate")());h=b}function d(b,c){window.addEventListener?window.addEventListener(b,c,!1):window.attachEvent&&window.attachEvent("on"+b,c)}function e(b){var e=window.location.hash?window.location.hash.substring(1):null;if(k!==e){if(!0!==b){for(l.push({hash:e,
time:(new Date).getTime()});1E3<l.length;)l.shift();a.console.log("a.page.event.hash: hash change (previous: "+k+", new: "+e+")",3);c("hash",{value:e,old:k})()}k=e}}var f={},g=1E4,h=(new Date).getTime(),k=null,l=[];f.hash={getHash:function(){return window.location.hash?window.location.hash.substring(1):null},getPreviousHash:function(){return k},setPreviousHash:function(b){a.console.log("a.page.event.hash.setPreviousHash: change previous hash to "+b,3);k=b},trace:function(){return l}};e(!0);!a.isNull(window.onhashchange)&&
(void 0===document.documentMode||7<document.documentMode)?window.onhashchange=e:a.timer.add(e,null,50);var u=["resize","load","unload"],p;for(p in u)d(u[p],c(u[p]));d("load",function(){a.timer.add(b,null,g)});return f}();a.state=function(){function c(b){return a.isArray(b)?b.reverse():a.isString(b)?[b]:[]}function b(){for(var b=n;n===b||0>=n;)n=Math.floor(1E5*Math.random());return n}function d(b,c){var e=[],d=b.length;c=a.isFunction(c)?c:function(){return!0};for(var f=0;f<d;++f){for(var g=!1,h=0;h<d;++h)if(f!=h&&b[f].id===b[h].id&&c(b[f])){g=!0;break}g||e.push(b[f].id)}return e}function e(b){for(var c=0,e=[],d=a.state.helper.tree.selectLevel(b,l,c);0<d.length;)e.push(d),c++,d=a.state.helper.tree.selectLevel(b,l,c);
return e}function f(b){b=g(b);for(var c=s.length,e=[];c--;){for(var d=s[c].hashtagList,f=d.length,h=!1;f--&&(h=b({hash:d[f]}),!0!==h););h||(e=e.concat(s[c].itemList.slice()),s.splice(c,1))}return e}function g(b){return function(c){if(a.isObject(c)&&0<c.hash.length){if(c.hash===b)return!0;if(0<=c.hash.indexOf("{{")&&0<=c.hash.indexOf("}}")){var e=a.state.helper.parameter.extract(c.hash);c=c.hash;for(var d=e.length;d--;)c=a.state.helper.parameter.replace(c,e[d]);return RegExp("^"+c+"$","gi").test(b)}}return!1}}
function h(b){return function(c){return a.isObject(c)&&(a.isArray(b)&&a.contains(b,c.id)||c.id===b)?!0:!1}}function k(b,c){var e=h(c),d=g(b);return function(b){return!0===e(b)||!0===d(b)?!0:!1}}function l(b){return a.isObject(b)&&a.isArray(b.children)?b.children:[]}function u(b){return a.isObject(b)?b.id:-1}function p(c){var h=a.clone(m),w=a.clone(m),r=a.clone(m),q=f(c.value),y=g(c.old),q=k(c.old,q),s=g(c.value);a.state.helper.tree.selectBranch(h,l,q);a.state.helper.tree.selectBranch(w,l,s);a.state.helper.tree.selectBranch(r,
l,g("*"));var q=a.state.helper.tree.flat(h.concat(w),l),p=d(q,function(b){return 0<=b.hash.indexOf("{{")&&0<=b.hash.indexOf("}}")&&!a.state.helper.tree.isInBranch(b,l,s)&&!a.state.helper.tree.isInBranch(b,l,y)?!1:!0}),n=a.state.helper.tree.flat(r,l,u),h=e(h),t=e(w);a.message.dispatch("a.state.begin",c);a.console.log("a.state: element allowed to proceed change: "+p+" (does not mean all of them will be loaded)",3);var z=b();a.state.helper.chainer("unload",h,p,-1,function(){a.state.helper.chainer("load",
t,p,z,function(){0<r.length?(r=[r],a.console.log("a.state: wildcard allowed to proceed change: "+n+" (does not mean all of them will be loaded)",3),a.state.helper.chainer("unload",r,n,-1,function(){a.state.helper.chainer("load",r,n,-1,function(){a.message.dispatch("a.state.end",c)})})):a.message.dispatch("a.state.end",c)})})}var m=[],s=[],n=-1,t=[];a.message.addListener("a.page.event.hash",p);a.message.addListener("a.message.clear",function(){a.message.addListener("a.page.event.hash",p)});return{clear:function(){m=
[]},tree:function(){return a.clone(m)},add:function(b,e){if(!a.isObject(b))return null;if(a.isArray(b))for(var d=0,f=b.length;d<f;++d)this.add(b[d]);else{b.hash=a.isString(b.hash)?b.hash:"";a.isObject(b.include)||(b.include={});b.include.css=c(b.include.css);b.include.js=c(b.include.js);b.include.translate=c(b.include.translate);b.include.html=a.isString(b.include.html)?b.include.html:null;for(var g=["preLoad","postLoad","preUnload","unload","postUnload"],k=0,d=g.length;k<d;++k)f=b[g[k]],a.isFunction(f)&&
(f=f.toString(),f=f.slice(f.indexOf("(")+1,f.indexOf(")")).match(/([^\s,]+)/g),a.isNull(f)&&a.console.warn("The result parameter for function '"+g[k]+"' in id '"+b.id+"' has not been found, the state may not work properly",2));!a.isArray(b.children)&&a.isObject(b.children)&&(b.children=[a.clone(b.children)]);k=!a.isNull(b.parent);d=a.isArray(b.children);"*"===b.hash&&(k&&a.console.warn("a.state.add : The wildcard has a parent setted (not allowed)",1),d&&a.console.warn("a.state.add : The wildcard has children (not allowed)",
1),b.parent=null,k=!1,b.children=[]);g=[];d&&(g=b.children.slice());b.children=[];a.isNull(b.id)&&(b.id=1);for(;!a.isNull(a.state.helper.tree.getItem(m,l,h(b.id)));)b.id=Math.floor(1E5*Math.random()+1);if(k){k=a.state.helper.tree.getItem(m,l,h(b.parent));if(a.isNull(k))return null;k.children.push(b)}else m.push(b);k=b.id;d=0;for(f=g.length;d<f;++d)a.isObject(g[d])&&(g[d].parent=k,this.add(g[d]));"*"===b.hash&&a.state.helper.chainer("load",[[b]],[k],-1,function(){});!0===b.bootOnLoad&&(g=a.clone(b),
g.data=g.converter=g.options=null,g.preLoad=g.load=g.postLoad=null,g.preUnload=g.unload=g.postUnload=null,e=a.isFunction(e)?e:function(){},a.state.helper.chainer("load",[[g]],[k],-1,e));return k}},getById:function(b){return a.state.helper.tree.getItem(m,l,h(b))},removeById:function(b){var c=a.state.helper.tree.getItem(m,l,h(b));a.console.log("a.state.removeById: remove element (id: "+b+")",3);a.state.helper.tree.selectBranch(m,l,function(b){return b===c?!1:!0})},loadById:function(b,f,k){var r=a.clone(m),
q=a.page.event.hash.getHash(),p=a.clone(m);a.state.helper.tree.selectBranch(r,l,h(b));a.state.helper.tree.selectBranch(p,l,g(q));var n=a.state.helper.tree.flat(r,l),p=a.state.helper.tree.flat(p,l),p=d(p.concat(n)),r=e(r);k=a.isFunction(k)?k:function(){};a.console.log("a.state.loadById: element allowed to proceed change: "+p+" (does not mean all of them will be loaded)",3);a.state.helper.chainer("load",r,p,-1,k);a.isNull(f)&&(f=q);b={id:b,itemList:a.state.helper.tree.flat(n,l,u),hashtagList:c(f)};
s.push(b)},unloadById:function(b,c){for(var d=this.getById(b),d=e([d]),f=[],g=s.length;g--;)f=f.concat(s[g].itemList);a.console.log("a.state.unloadById: element allowed to proceed change: "+f+" (does not mean all of them will be unloaded)",3);g=a.isFunction(c)?c:function(){};a.state.helper.chainer("unload",d,f,-1,g)},forceReloadById:function(c,d){for(var f=a.isFunction(d)?d:function(){},h=s.length,k=[],p=a.clone(s);h--;)a.contains(s[h].itemList,c)&&k.push(s[h].hashtagList);if(0<k.length)this.unloadById(c,
function(){for(var b=k.length;b--;)a.state.loadById(c,k[b]);s=p;f()});else{var h=a.clone(m),n=a.page.event.hash.getHash();a.state.helper.tree.selectBranch(h,l,g(n));for(var n=a.state.helper.tree.flat(h,l),t=n.length;t--;)if(n[t].id===c){var B=e([n[t]]),A=a.state.helper.tree.flat(h,l,u);a.console.log("a.state.forceReloadById: element allowed to proceed change: "+A+" (does not mean all of them will be loaded/unloaded)",3);var z=b();a.state.helper.chainer("unload",B,A,-1,function(){a.state.helper.chainer("load",
B,A,z,f)});break}}},hashExists:function(b){return a.isString(b)&&""!==b?a.state.helper.tree.isInBranch(m,l,g(b)):!1},__currentGeneratedId:function(){return n},type:{add:function(b,c){t[b]=c},get:function(b){return a.isFunction(t[b])?t[b]:null},list:function(){return t}},helper:{tree:{},chainer:{},parameter:{}}}}();
a.state.helper.tree={flat:function(c,b,d){var e=[];if(!a.isArray(c)||!a.isFunction(b))return[];d=a.isFunction(d)?d:function(b){return b};for(var f=0,g=c.length;f<g;++f){var h=this.flat(b(c[f]),b,d);e.push(d(c[f]));0<h.length&&(e=e.concat(h))}return e},getItem:function(c,b,d){if(!a.isArray(c)||!a.isFunction(d)||!a.isFunction(b))return null;for(var e=0,f=c.length;e<f;++e){if(!0===d(c[e]))return c[e];var g=this.getItem(b(c[e]),b,d);if(!a.isNull(g))return g}return null},isInBranch:function(c,b,d){c=this.getItem(c,
b,d);return a.isNull(c)?!1:!0},selectBranch:function(c,b,d){if(a.isArray(c)&&a.isFunction(b)&&a.isFunction(d))for(var e=c.length;e--;){var f=b(c[e]);!1===d(c[e])&&a.isNull(this.getItem(f,b,d))?c.splice(e,1):0<f.length&&this.selectBranch(f,b,d)}},selectLevel:function(c,b,d){if(!a.isArray(c)||!a.isFunction(b))return[];var e=[],f=c.length;if(a.isNull(d)||isNaN(d)||0>=d)return c;for(d--;f--;){var g=b(c[f]);0<g.length&&(e=e.concat(this.selectLevel(g,b,d)))}return e}};
a.state.helper.chainer=function(c,b,d,e,f){function g(b,c){var e={};a.isNull(b)||(e.resource=b);a.isNull(c)||(e.status=c);a.message.dispatch("a.state.error",e)}function h(b){return function(c){s(b,function(){c.done()})}}function k(b,c,e){return function(d){a.loader[b](c,function(b){a.isFunction(e)&&e(b);d.done()})}}function l(b,c,e){if(a.isObject(e))for(var d in e)e[d]=a.state.helper.parameter.extrapolate(e[d],b,c),l(b,c,e[d])}function u(b,c,e,d){var f=a.clone(e);e=a.page.event.hash.getHash();f.url=
a.state.helper.parameter.extrapolate(c,e,d);l(e,d,f);c=c.replace(/^\s+|\s+$/g,"");return 0===c.indexOf("{{")&&c.indexOf("}}")===c.length-2?(c=a.state.helper.parameter.extrapolate(c,e,d,!1),function(e){var d=e.getData("data")||{};a.isObject(d.a)||(d.a=d.appstorm={},d.a.parameter=d.appstorm.parameter={});a.isNull(b)?d=c:(d.a.parameter[b]=c,d.appstorm.parameter=d.a.parameter,a.isNull(d[b])&&(d[b]=c));e.setData("data",d);e.done()}):function(c){a.isNull(c.getData("data"))&&c.setData("data",{});(new a.ajax(f,
function(e){if(a.isNull(b))c.setData("data",e);else{var d=c.getData("data");d[b]=e;c.setData("data",d)}c.done()},g)).send()}}function p(b,c){for(var e=new a.callback.synchronizer,d=b.include.css,f=b.include.js,h=b.include.html,l=b.include.translate,m=b.data,p=b.title,n=b.options,s=b.converter,t=b.hash,x=d.length,E=f.length;x--;)e.addCallback(k("css",d[x]));for(;E--;)e.addCallback(k("js",f[E]));if(!a.isNull(a.language)&&0<l.length)for(d=l.length;d--;)e.addCallback(k("json",l[d],function(b){for(var c in b)a.language.addTranslation(c,
b[c],!0)}));a.isString(h)&&(h=a.state.helper.parameter.extrapolate(h,a.page.event.hash.getHash(),t),e.addCallback(function(b){b.setData("html",h);a.page.template.get(h,{},b.done,g)}));if(a.isString(m)||a.isObject(m))if(a.isObject(n)||(n={type:"json"}),a.isString(n.type)||(n.type="json"),a.isString(m))e.addCallback(u(null,m,n,t));else for(var C in m)a.isObject(m[C])&&a.isString(m[C].url)?(a.isObject(m[C].options)||(m[C].options={type:"json"}),e.addCallback(u(C,m[C].url,m[C].options,t))):e.addCallback(u(C,
m[C],n,t));else e.addCallback(function(b){b.setData("data",{});b.done()});e.setSuccess(function(b){a.isNull(s)||s(b.data);a.isNull(p)||(p=a.state.helper.parameter.extrapolate(p,a.page.event.hash.getHash(),t),a.isNull(a.language)?document.title=p:document.title=a.language.getSingleTranslation(p));var e=b.data,d=b.html,e=a.isNull(e)?{}:e;a.isNull(d)?a.isFunction(c)&&c(b,null):a.page.template.get(d,e,function(e){a.isFunction(c)&&c(b,e)})});e.setFail(g);e.start()}function m(b,d){var f=new a.callback.chainer;
"unload"===c?f.addCallback(b.preUnload,b.unload,b.postUnload):f.addCallback(function(c){a.isFunction(b.preLoad)&&(-1==e||0<=e&&a.state.__currentGeneratedId()===e)?b.preLoad(c):c.done()},function(c){p(b,function(d,f){a.isFunction(b.load)&&(-1==e||0<=e&&a.state.__currentGeneratedId()===e)&&b.load(f);var g=c.getFullData()||{};if(a.isObject(d.data))for(var h in d.data)g[h]=d.data[h];c.setFullData(g);c.done()})},function(c){a.isFunction(b.postLoad)&&(-1==e||0<=e&&a.state.__currentGeneratedId()===e)?b.postLoad(c):
c.done()});f.setSuccess(d);f.setFail(g);f.start()}function s(b,c){for(var e=new a.callback.synchronizer,f=b.length;f--;)a.contains(d,b[f].id)&&function(b){e.addCallback(function(c){m(b,function(){c.done()})})}(b[f]);e.setSuccess(c);e.setFail(g);e.start()}var n=b.length;c="unload"===c?"unload":"load";d=d||[];var t=new a.callback.chainer;if("unload"===c)for(;n--;)t.addCallback(h(b[n]));else for(var x=0;x<n;)t.addCallback(h(b[x])),x++;t.setSuccess(f);t.setFail(g);t.start()};
a.state.helper.parameter={extract:function(c,b){var d=/\{\{(\s*\w+\s*:\s*[a-z0-9_\-\[\]\(\)\^.\|\+\*\?\\\/]+\s*)\}\}/gmi,e=/^\s+|\s+$/g,f=!a.isNull(b);f&&(d=b);for(var g=[],h;h=d.exec(c);){var k=null,k=f?["hash",h[1]]:h[1].split(":",2);g.push({original:h[0].replace(e,""),name:k[0].replace(e,""),regex:k[1].replace(e,""),start:h.index})}return g},replace:function(c,b,d){d=a.isNull(d)?"("+b.regex+")":d;return c.substr(0,b.start)+d+c.substr(b.start+b.original.length)},extrapolate:function(c,b,d,e){if(a.isString(c)&&
0<=c.indexOf("{{")&&0<=c.indexOf("}}")){for(var f=this.extract(c),g=this.extract(d),h=this.extract(c,/\{\{(\s*\w+\s*)\}\}/gmi),f=f.concat(h),h=g.length;h--;)d=this.replace(d,g[h]);if(h=RegExp("^"+d+"$","gi").exec(b)){b=0;for(d=g.length;b<d;++b)g[b].value=h[b+1];for(var h=0,k=f.length;h<k;++h)for(b=0;b<d;++b)g[b].name===f[h].regex&&"hash"===f[h].name&&(f[h].value=g[b].value)}g=f.length;for(e=!1===e?function(b,c,e){return e}:this.replace;g--;){b=f[g];"hash"!==b.name&&"hashtag"!==b.name||a.isNull(b.value)||
(c=this.replace(c,b,b.value));d=!1;if(!a.isNull(a.storage))switch(b.name){case "temporary":c=e(c,b,a.storage.temporary.getItem(b.regex));d=!0;break;case "memory":c=e(c,b,a.storage.memory.getItem(b.regex));d=!0;break;case "persistent":c=e(c,b,a.storage.persistent.getItem(b.regex));d=!0;break;case "cookie":c=e(c,b,a.storage.cookie.getItem(b.regex));d=!0;break;case "store":case "storage":d=a.storage.temporary.getItem(b.regex),c=a.isNull(d)?e(c,b,a.storage.persistent.getItem(b.regex)):e(c,b,d),d=!0}if(!d&&
(d=a.state.type.list(),a.isObject(d)))for(var l in d)l===b.name&&(h=d[l],c=a.isFunction(h)?e(c,b,h(b.regex)):e(c,b,h))}}return c}};a.storage={__printGetItem:function(c,b,d){"__test_support"!==b&&a.console.log("a.storage.type."+c+".getItem: get element (key: "+b+", value: "+d+")",3)},__printGetErrorItem:function(c,b){"__test_support"!==b&&a.console.log("a.storage.type."+c+".getItem: unable to find key ("+b+") in store",2)},__printSetItem:function(c,b,d){"__test_support"!==b&&a.console.log("a.storage.type."+c+".setItem: add element (key: "+b+", value: "+d+")",3)},__printRemoveItem:function(c,b){"__test_support"!==b&&a.console.log("a.storage.type."+
c+".removeItem: remove element (key: "+b+")",3)},type:{}};
a.storage.type.cookie=function(){var c=!1,b={support:!1,engine:"cookie",setItem:function(b,c,f){var g="";a.storage.__printSetItem("cookie",b,c);f&&(g=new Date,g.setTime(g.getTime()+864E5*f),g="; expires="+g.toGMTString());document.cookie=b+"="+escape(a.parser.json.stringify(c))+g+"; path=/"},getItem:function(b){if(0<document.cookie.length){var c=document.cookie.indexOf(b+"=");if(-1!=c){var c=c+b.length+1,f=document.cookie.indexOf(";",c);-1==f&&(f=document.cookie.length);c=a.parser.json.parse(unescape(document.cookie.substring(c,
f)));a.storage.__printGetItem("cookie",b,c);return c}}a.storage.__printGetErrorItem("cookie",b);return null},removeItem:function(b){a.storage.__printRemoveItem("cookie",b);this.setItem(b,"",-1);c&&a.message.dispatch("a.storage.remove",{key:b})}};b.setItem("__test_support","ok");"ok"===b.getItem("__test_support")&&(b.removeItem("__test_support"),b.support=!0);c=!0;return b}();a.storage.cookie=a.storage.type.cookie;
a.storage.type.localStorage=function(){var c=!1;"localStorage"in window&&null!==window.localStorage&&(window.localStorage.setItem("__test_support","o"),"o"===window.localStorage.getItem("__test_support")&&(window.localStorage.removeItem("__test_support"),c=!0));return{support:c,engine:"localStorage",getItem:function(b){if(c){var d=window.localStorage.getItem(b);if(a.isNull(d))return a.storage.__printGetErrorItem("localStorage",b),null;d=a.parser.json.parse(d);a.storage.__printGetItem("localStorage",
b,d);return d}return null},setItem:function(b,d){c&&(a.storage.__printSetItem("localStorage",b,d),window.localStorage.setItem(b,a.parser.json.stringify(d)),a.message.dispatch("a.storage.add",{key:b,value:d}))},removeItem:function(b){c&&(a.storage.__printRemoveItem("localStorage",b),window.localStorage.removeItem(b),a.message.dispatch("a.storage.remove",{key:b}))}}}();
a.storage.type.globalStorage=function(){var c=!1,b=window.location.hostname;a.isNull(window.globalStorage)||(window.globalStorage[b].setItem("__test_support","ok"),"ok"==window.globalStorage[b].getItem("__test_support")&&(window.globalStorage[b].removeItem("__test_support"),c=!0));return{support:c,engine:"globalStorage",getItem:function(d){if(c){var e=window.globalStorage[b].getItem(d);if(a.isObject(e)&&!a.isNull(e.value))return e=a.parser.json.parse(e.value),a.storage.__printGetItem("globalStorage",
d,e),e;if(a.isNull(e))a.storage.__printGetErrorItem("globalStorage",d);else return e=a.parser.json.parse(e),a.storage.__printGetItem("globalStorage",d,e),e}return null},setItem:function(d,e){c&&(a.storage.__printSetItem("globalStorage",d,e),window.globalStorage[b].setItem(d,a.parser.json.stringify(e)),a.message.dispatch("a.storage.add",{key:d,value:e}))},removeItem:function(d){c&&(a.storage.__printRemoveItem("globalStorage",d),window.globalStorage[b].removeItem(d),a.message.dispatch("a.storage.remove",
{key:d}))}}}();
a.storage.type.memory=function(){var c={};return{support:!0,engine:"memory",getItem:function(b){var d=c[b];if(!a.isNull(d))return a.storage.__printGetItem("memory",b,d),a.console.log("a.storage.memory.getItem: found item (key: "+b+", value: "+d+")",3),d;a.storage.__printGetErrorItem("memory",b);return null},setItem:function(b,d){c[b]=d;a.storage.__printSetItem("memory",b,d);a.message.dispatch("a.storage.add",{key:b,value:d})},removeItem:function(b){a.storage.__printRemoveItem("memory",b);a.isNull(c[b])||
(delete c[b],a.message.dispatch("a.storage.remove",{key:b}))}}}();a.storage.memory=a.storage.type.memory;
a.storage.type.sessionStorage=function(){var c=!1;"sessionStorage"in window&&!a.isNull(window.sessionStorage)&&(window.sessionStorage.setItem("__test_support","o"),"o"===window.sessionStorage.getItem("__test_support")&&(window.sessionStorage.removeItem("__test_support"),c=!0));return{support:c,engine:"sessionStorage",getItem:function(b){if(c){var d=window.sessionStorage.getItem(b);if(a.isNull(d))return a.storage.__printGetErrorItem("sessionStorage",b),null;d=a.parser.json.parse(d);a.storage.__printGetItem("sessionStorage",
b,d);return d}return null},setItem:function(b,d){c&&(a.storage.__printSetItem("sessionStorage",b,d),window.sessionStorage.setItem(b,a.parser.json.stringify(d)),a.message.dispatch("a.storage.add",{key:b,value:d}))},removeItem:function(b){c&&(a.storage.__printRemoveItem("sessionStorage",b),window.sessionStorage.removeItem(b),a.message.dispatch("a.storage.remove",{key:b}))}}}();
a.storage.type.userData=function(){var c=!1;if(document.all)try{document.write('<input type="hidden" id="a_storage" style="display:none;behavior:url(\'#default#userData\')" />');var b=document.getElementById("a_storage");b.load("aUserDataStorage");b.setAttribute("__test_support","ok");b.save("aUserDataStorage");"ok"===b.getAttribute("__test_support")&&(b.removeAttribute("__test_support"),b.save("aUserDataStorage"),c=!0)}catch(d){c=!1}return{support:c,engine:"userData",getItem:function(e){if(c){var d=
a.parser.json.parse(b.getAttribute(e));if(a.isNull(d))return a.storage.__printGetErrorItem("userData",e),null;a.storage.__printGetItem("userData",e,d);return d}return null},setItem:function(e,d){c&&(a.storage.__printSetItem("userData",e,d),b.setAttribute(e,a.parser.json.stringify(d)),b.save("aUserDataStorage"),a.message.dispatch("a.storage.add",{key:e,value:d}))},removeItem:function(e){c&&(a.storage.__printRemoveItem("userData",e),b.removeAttribute(e),b.save("aUserDataStorage"),a.message.dispatch("a.storage.remove",
{key:e}))}}}();
a.storage.type.flash=function(){function c(c){if(!1===b&&!1===d){var g=document.createElement("div");g.id="flashstoragecontent";document.body.appendChild(g);var h={id:e,rootId:g.id,flashvars:{},params:{wmode:"transparent",menu:"false",scale:"noScale",allowFullscreen:"true",allowScriptAccess:"always"}};a.loader.flash(a.url+"vendor/storage/flash/localStorage.swf",function(e){d=!0;e=document.getElementById(h.id);!0===e.testData()&&(b=!0,e.setDatabase("a_flashStorage"));!0===b&&a.isFunction(c)&&c(b)},
h)}else!0===b&&a.isFunction(c)&&c(b)}var b=!1,d=!1,e="flashstorage";return{support:function(){return b},ready:function(){return d},engine:"flash",start:function(b){c(b)},getItem:function(c){this.start();if(!0===b){var d=document.getElementById(e).getData(c);if(a.isNull(d))return a.storage.__printGetErrorItem("flash",c),null;a.storage.__printGetItem("flash",c,d);return d}return null},setItem:function(c,d){this.start();!0===b&&(a.storage.__printSetItem("flash",c,d),document.getElementById(e).setData(c,
d))},removeItem:function(c){this.start();if(!0===b)return a.storage.__printRemoveItem("flash",c),document.getElementById(e).removeData(c)}}}();
a.storage.type.silverlight=function(){function c(c){if(!1===b&&!1===d){var g=document.createElement("div");g.id="__silverlightstorage";document.body.appendChild(g);var h={id:e,rootId:g.id,params:[{name:"minRuntimeVersion",value:"2.0.31005.0"},{name:"autoUpgrade",value:"true"}]};a.loader.silverlight(a.url+"vendor/storage/silverlight/silverlightStorage.xap",function(e){d=!0;!0===document.getElementById(h.id).Content.store.testData()&&(b=!0);!0===b&&a.isFunction(c)&&c(b)},h)}else!0===b&&a.isFunction(c)&&
c(b)}var b=!1,d=!1,e="silverlightstorage";return{support:function(){return b},ready:function(){return d},engine:"silverlight",start:function(b){c(b)},getItem:function(c){this.start();if(!0===b){var d=document.getElementById(e).Content.store.loadData(c);if(a.isNull(d)||"false"===d)return a.storage.__printGetErrorItem("silverlight",c),null;d=a.parser.json.parse(d);a.storage.__printGetItem("silverlight",c,d);return d}return null},setItem:function(c,d){this.start();!0===b&&(a.storage.__printSetItem("silverlight",
c,d),document.getElementById(e).Content.store.saveData(c,a.parser.json.stringify(d)))},removeItem:function(c){this.start();!0===b&&(a.storage.__printRemoveItem("silverlight",c),document.getElementById(e).Content.store.removeData(c))}}}();
a.storage.type.javafx=function(){function c(c){!1===b&&!1===d?a.loader.javafx(a.url+"vendor/storage/javafx/JavaFXStorage.jar",function(){d=!0;!0===document.getElementById("javafxstorage").Packages.javafxstorage.localStorage.testData()&&(b=!0,el.setDatabase("a_javafxStorage"));!0===b&&a.isFunction(c)&&c(b)},{code:"javafxstorage.Main",id:"javafxstorage"}):!0===b&&a.isFunction(c)&&c(b)}var b=!1,d=!1;return{support:function(){return b},ready:function(){return d},engine:"javafx",start:function(b){c(b)},
getItem:function(c){this.start();if(!0===b){var d=document.getElementById("javafxstorage").Packages.javafxstorage.localStorage.loadData(c);if(a.isNull(d)||"false"===d)return a.storage.__printGetErrorItem("javafx",c),null;d=a.parser.json.parse(d);a.storage.__printGetItem("javafx",c,d);return d}return null},setItem:function(c,d){this.start();!0===b&&(a.storage.__printSetItem("javafx",c,d),document.getElementById("javafxstorage").Packages.javafxstorage.localStorage.saveData(c,a.parser.json.stringify(d)))},
removeItem:function(c){this.start();!0===b&&(a.storage.__printRemoveItem("javafx",c),document.getElementById("javafxstorage").Packages.javafxstorage.localStorage.removeData(c))}}}();a.storage.temporary=function(){for(var c=["sessionStorage","cookie","memory"],b=0,d=c.length;b<d;++b){var e=c[b];if(a.storage.type[e].support)return a.console.log("a.storage.temporary: choosing storage "+a.storage.type[e].engine,3),a.message.dispatch("a.storage.temporary.change",{engine:e}),a.storage.type[e]}return null}();
a.storage.external=function(){function c(b,c){a.storage.external.ready=b.ready;a.storage.external.support=b.support;a.storage.external.engine=b.engine;a.storage.external.getItem=b.getItem;a.storage.external.setItem=b.setItem;a.storage.external.removeItem=b.removeItem;a.isFunction(c)&&c()}return{start:function(b){var d=a.storage.type.silverlight,e=a.storage.type.flash,f=a.storage.type.javafx;d.start(function(g){g?(a.console.log("a.storage.external: choosing storage silverlight",3),c(d,b)):e.start(function(d){d?
(a.console.log("a.storage.external: choosing storage flash",3),c(e,b)):f.start(function(d){d?(a.console.log("a.storage.external: choosing storage javafx",3),c(f,b)):a.console.warn("a.storage.external: choosing storage NONE AVAILABLE",3)})})})}}}();
a.storage.persistent=function(){for(var c=["localStorage","globalStorage","userData","cookie"],b=0,d=c.length;b<d;++b){var e=c[b];if(a.storage.type[e].support)return a.console.log("a.storage.persistent: choosing storage "+a.storage.type[e].engine,3),a.message.dispatch("a.storage.persistent.change",{engine:e}),a.storage.type[e]}return null}();
null==a.storage.persistent&&(a.storage.persistent={},a.storage.persistent.support=!1,a.storage.persistent.engine=function(){return"none"},a.storage.persistent.getItem=function(){return null},a.storage.persistent.setItem=function(){},a.storage.persistent.removeItem=function(){});a.storage.support=a.storage.persistent.support;a.storage.engine=a.storage.persistent.engine;a.storage.getItem=a.storage.persistent.getItem;a.storage.setItem=a.storage.persistent.setItem;a.storage.removeItem=a.storage.persistent.removeItem;
