(function(c,b){if("object"==typeof exports&&exports)b(exports);else{var d={};b(d);"function"==typeof define&&define.amd?define(d):c.Mustache=d}})(this,function(c){function b(b){return b.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function d(b){this.tail=this.string=b;this.pos=0}function e(b,d){this.view=b||{};this.parent=d;this._cache={}}function f(){this.clearCache()}function h(b,d,e,f){for(var m,k,g,n="",q=0,t=b.length;t>q;++q)switch(m=b[q],k=m[1],m[0]){case "#":if(g=e.lookup(k),"object"==typeof g)if(p(g)){k=
0;for(var s=g.length;s>k;++k)n+=h(m[4],d,e.push(g[k]),f)}else g&&(n+=h(m[4],d,e.push(g),f));else"function"==typeof g?(k=null==f?null:f.slice(m[3],m[5]),g=g.call(e.view,k,function(b){return d.render(b,e)}),null!=g&&(n+=g)):g&&(n+=h(m[4],d,e,f));break;case "^":g=e.lookup(k);(!g||p(g)&&0===g.length)&&(n+=h(m[4],d,e,f));break;case ">":g=d.getPartial(k);"function"==typeof g&&(n+=g(e));break;case "&":g=e.lookup(k);null!=g&&(n+=g);break;case "name":g=e.lookup(k);null!=g&&(n+=c.escape(g));break;case "text":n+=
k}return n}function g(d){return[RegExp(b(d[0])+"\\s*"),RegExp("\\s*"+b(d[1]))]}var s=/\s*/,k=/\s+/,x=/\S/,t=/\s*=/,r=/\s*\}/,w=/#|\^|\/|>|\{|&|=|!/,u=RegExp.prototype.test,q=Object.prototype.toString,p=Array.isArray||function(b){return"[object Array]"===q.call(b)},m={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};d.prototype.eos=function(){return""===this.tail};d.prototype.scan=function(b){return(b=this.tail.match(b))&&0===b.index?(this.tail=this.tail.substring(b[0].length),
this.pos+=b[0].length,b[0]):""};d.prototype.scanUntil=function(b){var d=this.tail.search(b);switch(d){case -1:b=this.tail;this.pos+=this.tail.length;this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,d),this.tail=this.tail.substring(d),this.pos+=d}return b};e.make=function(b){return b instanceof e?b:new e(b)};e.prototype.push=function(b){return new e(b,this)};e.prototype.lookup=function(b){var d=this._cache[b];if(!d){if("."==b)d=this.view;else for(var c=this;c;){if(0<b.indexOf("."))for(var d=
c.view,e=b.split("."),p=0;d&&e.length>p;)d=d[e[p++]];else d=c.view[b];if(null!=d)break;c=c.parent}this._cache[b]=d}return"function"==typeof d&&(d=d.call(this.view)),d};f.prototype.clearCache=function(){this._cache={};this._partialCache={}};f.prototype.compile=function(b,d){var e=this._cache[b];e||(e=c.parse(b,d),e=this._cache[b]=this.compileTokens(e,b));return e};f.prototype.compilePartial=function(b,d,c){d=this.compile(d,c);return this._partialCache[b]=d,d};f.prototype.getPartial=function(b){return b in
this._partialCache||!this._loadPartial||this.compilePartial(b,this._loadPartial(b)),this._partialCache[b]};f.prototype.compileTokens=function(b,d){var c=this;return function(p,f){if(f)if("function"==typeof f)c._loadPartial=f;else for(var k in f)c.compilePartial(k,f[k]);return h(b,c,e.make(p),d)}};f.prototype.render=function(b,d,c){return this.compile(b)(d,c)};c.name="mustache.js";c.version="0.7.2";c.tags=["{{","}}"];c.Scanner=d;c.Context=e;c.Writer=f;c.parse=function(e,p){if(e=e||"",p=p||c.tags,"string"==
typeof p&&(p=p.split(k)),2!==p.length)throw Error("Invalid tags: "+p.join(", "));for(var f,m,n,h,q,z=g(p),C=new d(e),M=[],L=[],D=[],G=!1,N=!1;!C.eos();){if(f=C.pos,n=C.scanUntil(z[0]))for(var O=0,I=n.length;I>O;++O)if(h=n.charAt(O),u.call(x,h)?N=!0:D.push(L.length),L.push(["text",h,f,f+1]),f+=1,"\n"==h){if(G&&!N)for(;D.length;)delete L[D.pop()];else D=[];N=G=!1}if(!C.scan(z[0]))break;if(G=!0,m=C.scan(w)||"name",C.scan(s),"="===m?(n=C.scanUntil(t),C.scan(t),C.scanUntil(z[1])):"{"===m?(n=C.scanUntil(RegExp("\\s*"+
b("}"+p[1]))),C.scan(r),C.scanUntil(z[1]),m="&"):n=C.scanUntil(z[1]),!C.scan(z[1]))throw Error("Unclosed tag at "+C.pos);if(q=[m,n,f,C.pos],L.push(q),"#"===m||"^"===m)M.push(q);else if("/"===m){if(0===M.length)throw Error('Unopened section "'+n+'" at '+f);h=M.pop();if(h[1]!==n)throw Error('Unclosed section "'+h[1]+'" at '+f);}else if("name"===m||"{"===m||"&"===m)N=!0;else if("="===m){if(p=n.split(k),2!==p.length)throw Error("Invalid tags at "+f+": "+p.join(", "));z=g(p)}}if(h=M.pop())throw Error('Unclosed section "'+
h[1]+'" at '+C.pos);f=L;var H;n=[];q=0;for(z=f.length;z>q;++q)(m=f[q])&&("text"===m[0]&&H&&"text"===H[0]?(H[1]+=m[1],H[3]=m[3]):(H=m,n.push(m)));H=n;var J;m=f=[];n=[];q=0;for(z=H.length;z>q;++q)switch(J=H[q],J[0]){case "#":case "^":n.push(J);m.push(J);m=J[4]=[];break;case "/":n.pop()[5]=J[2];m=0<n.length?n[n.length-1][4]:f;break;default:m.push(J)}return f};c.escape=function(b){return(b+"").replace(/[&<>"'\/]/g,function(b){return m[b]})};var n=new f;c.clearCache=function(){return n.clearCache()};c.compile=
function(b,d){return n.compile(b,d)};c.compilePartial=function(b,d,c){return n.compilePartial(b,d,c)};c.compileTokens=function(b,d){return n.compileTokens(b,d)};c.render=function(b,d,c){return n.render(b,d,c)};c.to_html=function(b,d,e,p){b=c.render(b,d,e);return"function"!=typeof p?b:(p(b),void 0)}});(function(){function c(b,d,c){b.addEventListener?b.addEventListener(d,c,!1):b.attachEvent("on"+d,c)}function b(b){if("keypress"==b.type){var d=String.fromCharCode(b.which);b.shiftKey||(d=d.toLowerCase());return d}return t[b.which]?t[b.which]:r[b.which]?r[b.which]:String.fromCharCode(b.which).toLowerCase()}function d(b){b=b||{};var d=!1,c;for(c in n)b[c]?d=!0:n[c]=0;d||(l=!1)}function e(b,d,c,e,f){var m,k,g=[],h=c.type;if(!p[b])return[];"keyup"==h&&s(b)&&(d=[b]);for(m=0;m<p[b].length;++m)(k=p[b][m],
k.seq&&n[k.seq]!=k.level||h!=k.action||("keypress"!=h||c.metaKey||c.ctrlKey)&&d.sort().join(",")!==k.modifiers.sort().join(","))||(e&&k.combo==f&&p[b].splice(m,1),g.push(k));return g}function f(b){var d=[];b.shiftKey&&d.push("shift");b.altKey&&d.push("alt");b.ctrlKey&&d.push("ctrl");b.metaKey&&d.push("meta");return d}function h(b,d,c){A.stopCallback(d,d.target||d.srcElement,c)||!1!==b(d,c)||(d.preventDefault&&d.preventDefault(),d.stopPropagation&&d.stopPropagation(),d.returnValue=!1,d.cancelBubble=
!0)}function g(d){"number"!==typeof d.which&&(d.which=d.keyCode);var c=b(d);c&&("keyup"==d.type&&v==c?v=!1:A.handleKey(c,f(d),d))}function s(b){return"shift"==b||"ctrl"==b||"alt"==b||"meta"==b}function k(b,d,c){if(!c){if(!q){q={};for(var e in t)95<e&&112>e||t.hasOwnProperty(e)&&(q[t[e]]=e)}c=q[b]?"keydown":"keypress"}"keypress"==c&&d.length&&(c="keydown");return c}function x(c,f,g,q,t){m[c+":"+g]=f;c=c.replace(/\s+/g," ");var r=c.split(" "),D,G,B=[];if(1<r.length){var A=c,I=g;n[A]=0;I||(I=k(r[0],
[]));c=function(){l=I;++n[A];clearTimeout(y);y=setTimeout(d,1E3)};g=function(c){h(f,c,A);"keyup"!==I&&(v=b(c));setTimeout(d,10)};for(q=0;q<r.length;++q)x(r[q],q<r.length-1?c:g,I,A,q)}else{G="+"===c?["+"]:c.split("+");for(r=0;r<G.length;++r)D=G[r],u[D]&&(D=u[D]),g&&"keypress"!=g&&w[D]&&(D=w[D],B.push("shift")),s(D)&&B.push(D);g=k(D,B,g);p[D]||(p[D]=[]);e(D,B,{type:g},!q,c);p[D][q?"unshift":"push"]({callback:f,modifiers:B,action:g,seq:q,level:t,combo:c})}}for(var t={8:"backspace",9:"tab",13:"enter",
16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},r={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},w={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},u={option:"alt",command:"meta",
"return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},q,p={},m={},n={},y,v=!1,l=!1,B=1;20>B;++B)t[111+B]="f"+B;for(B=0;9>=B;++B)t[B+96]=B;c(document,"keypress",g);c(document,"keydown",g);c(document,"keyup",g);var A={bind:function(b,d,c){b=b instanceof Array?b:[b];for(var e=0;e<b.length;++e)x(b[e],d,c);return this},unbind:function(b,d){return A.bind(b,function(){},d)},trigger:function(b,d){if(m[b+":"+d])m[b+":"+d]({},b);return this},reset:function(){p={};
m={};return this},stopCallback:function(b,d){return-1<(" "+d.className+" ").indexOf(" mousetrap ")?!1:"INPUT"==d.tagName||"SELECT"==d.tagName||"TEXTAREA"==d.tagName||d.contentEditable&&"true"==d.contentEditable},handleKey:function(b,c,p){c=e(b,c,p);var f,m={},k=0,g=!1;for(f=0;f<c.length;++f)c[f].seq&&(k=Math.max(k,c[f].level));for(f=0;f<c.length;++f)c[f].seq?c[f].level==k&&(g=!0,m[c[f].seq]=1,h(c[f].callback,p,c[f].combo)):g||h(c[f].callback,p,c[f].combo);p.type==l&&!s(b)&&d(m)}};window.Mousetrap=
A;"function"===typeof define&&define.amd&&define(A)})();(function(){function c(c){var p,m,g,n="json"==c;if(n||"json-stringify"==c||"json-parse"==c){if("json-stringify"==c||n){if(p="function"==typeof k.stringify&&A){(g=function(){return 1}).toJSON=g;try{p="0"===k.stringify(0)&&"0"===k.stringify(new Number)&&'""'==k.stringify(new String)&&k.stringify(f)===b&&k.stringify(b)===b&&k.stringify()===b&&"1"===k.stringify(g)&&"[1]"==k.stringify([g])&&"[null]"==k.stringify([b])&&"null"==k.stringify(e)&&"[null,null,null]"==k.stringify([b,f,e])&&'{"A":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==
k.stringify({A:[g,d,!1,e,"\x00\b\n\f\r\t"]})&&"1"===k.stringify(e,g)&&"[\n 1,\n 2\n]"==k.stringify([1,2],e,1)&&'"-271821-04-20T00:00:00.000Z"'==k.stringify(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==k.stringify(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==k.stringify(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==k.stringify(new Date(-1))}catch(h){p=!1}}if(!n)return p}if("json-parse"==c||n){if("function"==typeof k.parse)try{if(0===k.parse("0")&&!k.parse(!1)&&(g=k.parse('{"A":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'),
m=5==g.a.length&&1==g.a[0])){try{m=!k.parse('"\t"')}catch(q){}if(m)try{m=1!=k.parse("01")}catch(y){}}}catch(l){m=!1}if(!n)return m}return p&&m}}var b=void 0,d=!0,e=null,f={}.toString,h,g,s="function"===typeof define&&define.c,k=!s&&"object"==typeof exports&&exports;k||s?"object"==typeof JSON&&JSON?s?k=JSON:(k.stringify=JSON.stringify,k.parse=JSON.parse):s&&(k=this.JSON={}):k=this.JSON||(this.JSON={});var x,t,r,w,u,q,p,m,n,y,v,l,B,A=new Date(-0xc782b5b800cec),E,F,z;try{A=-109252==A.getUTCFullYear()&&
0===A.getUTCMonth()&&1==A.getUTCDate()&&10==A.getUTCHours()&&37==A.getUTCMinutes()&&6==A.getUTCSeconds()&&708==A.getUTCMilliseconds()}catch(C){}c("json")||(A||(E=Math.floor,F=[0,31,59,90,120,151,181,212,243,273,304,334],z=function(b,d){return F[d]+365*(b-1970)+E((b-1969+(d=+(1<d)))/4)-E((b-1901+d)/100)+E((b-1601+d)/400)}),(h={}.hasOwnProperty)||(h=function(b){var d={},c;(d.__proto__=e,d.__proto__={toString:1},d).toString!=f?h=function(b){var d=this.__proto__;b=b in(this.__proto__=e,this);this.__proto__=
d;return b}:(c=d.constructor,h=function(b){var d=(this.constructor||c).prototype;return b in this&&!(b in d&&this[b]===d[b])});d=e;return h.call(this,b)}),g=function(b,d){var c=0,p,m,k;(p=function(){this.valueOf=0}).prototype.valueOf=0;m=new p;for(k in m)h.call(m,k)&&c++;p=m=e;c?c=2==c?function(b,d){var c={},e="[object Function]"==f.call(b),p;for(p in b)e&&"prototype"==p||h.call(c,p)||(c[p]=1)&&h.call(b,p)&&d(p)}:function(b,d){var c="[object Function]"==f.call(b),e,p;for(e in b)c&&"prototype"==e||
!h.call(b,e)||(p="constructor"===e)||d(e);(p||h.call(b,e="constructor"))&&d(e)}:(m="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),c=function(b,d){var c="[object Function]"==f.call(b),e;for(e in b)c&&"prototype"==e||!h.call(b,e)||d(e);for(c=m.length;e=m[--c];h.call(b,e)&&d(e));});c(b,d)},c("json-stringify")||(x={"\\":"\\\\",'"':'\\"',"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},t=function(b,d){return("000000"+(d||0)).slice(-b)},
r=function(b){for(var d='"',c=0,e;e=b.charAt(c);c++)d+=-1<'\\"\b\f\n\r\t'.indexOf(e)?x[e]:x[e]=" ">e?"\\u00"+t(2,e.charCodeAt(0).toString(16)):e;return d+'"'},w=function(c,p,m,k,n,q,y){var l=p[c],v,s,x,u,B,A,C,F,K;if("object"==typeof l&&l)if(v=f.call(l),"[object Date]"!=v||h.call(l,"toJSON"))"function"==typeof l.toJSON&&("[object Number]"!=v&&"[object String]"!=v&&"[object Array]"!=v||h.call(l,"toJSON"))&&(l=l.toJSON(c));else if(l>-1/0&&l<1/0){if(z){x=E(l/864E5);for(v=E(x/365.2425)+1970-1;z(v+1,0)<=
x;v++);for(s=E((x-z(v,0))/30.42);z(v,s+1)<=x;s++);x=1+x-z(v,s);u=(l%864E5+864E5)%864E5;B=E(u/36E5)%24;A=E(u/6E4)%60;C=E(u/1E3)%60;u%=1E3}else v=l.getUTCFullYear(),s=l.getUTCMonth(),x=l.getUTCDate(),B=l.getUTCHours(),A=l.getUTCMinutes(),C=l.getUTCSeconds(),u=l.getUTCMilliseconds();l=(0>=v||1E4<=v?(0>v?"-":"+")+t(6,0>v?-v:v):t(4,v))+"-"+t(2,s+1)+"-"+t(2,x)+"T"+t(2,B)+":"+t(2,A)+":"+t(2,C)+"."+t(3,u)+"Z"}else l=e;m&&(l=m.call(p,c,l));if(l===e)return"null";v=f.call(l);if("[object Boolean]"==v)return""+
l;if("[object Number]"==v)return l>-1/0&&l<1/0?""+l:"null";if("[object String]"==v)return r(l);if("object"==typeof l){for(c=y.length;c--;)if(y[c]===l)throw TypeError();y.push(l);F=[];p=q;q+=n;if("[object Array]"==v){s=0;for(c=l.length;s<c;K||(K=d),s++)v=w(s,l,m,k,n,q,y),F.push(v===b?"null":v);c=K?n?"[\n"+q+F.join(",\n"+q)+"\n"+p+"]":"["+F.join(",")+"]":"[]"}else g(k||l,function(c){var e=w(c,l,m,k,n,q,y);e!==b&&F.push(r(c)+":"+(n?" ":"")+e);K||(K=d)}),c=K?n?"{\n"+q+F.join(",\n"+q)+"\n"+p+"}":"{"+F.join(",")+
"}":"{}";y.pop();return c}},k.stringify=function(b,d,c){var e,p,m,k,g,n;if("function"==typeof d||"object"==typeof d&&d)if("[object Function]"==f.call(d))p=d;else if("[object Array]"==f.call(d))for(m={},k=0,g=d.length;k<g;n=d[k++],("[object String]"==f.call(n)||"[object Number]"==f.call(n))&&(m[n]=1));if(c)if("[object Number]"==f.call(c)){if(0<(c-=c%1))for(e="",10<c&&(c=10);e.length<c;e+=" ");}else"[object String]"==f.call(c)&&(e=10>=c.length?c:c.slice(0,10));return w("",(n={},n[""]=b,n),p,m,e,"",
[])}),c("json-parse")||(u=String.fromCharCode,q={"\\":"\\",'"':'"',"/":"/",b:"\b",t:"\t",n:"\n",f:"\f",r:"\r"},p=function(){l=B=e;throw SyntaxError();},m=function(){for(var b=B,c=b.length,f,m,k,g,n;l<c;)if(f=b.charAt(l),-1<"\t\r\n ".indexOf(f))l++;else{if(-1<"{}[]:,".indexOf(f))return l++,f;if('"'==f){m="@";for(l++;l<c;)if(f=b.charAt(l)," ">f)p();else if("\\"==f)if(f=b.charAt(++l),-1<'\\"/btnfr'.indexOf(f))m+=q[f],l++;else if("u"==f){k=++l;for(g=l+4;l<g;l++)f=b.charAt(l),"0"<=f&&"9">=f||"a"<=f&&"f">=
f||"A"<=f&&"F">=f||p();m+=u("0x"+b.slice(k,l))}else p();else{if('"'==f)break;m+=f;l++}if('"'==b.charAt(l))return l++,m}else{k=l;"-"==f&&(n=d,f=b.charAt(++l));if("0"<=f&&"9">=f){for("0"==f&&(f=b.charAt(l+1),"0"<=f&&"9">=f)&&p();l<c&&(f=b.charAt(l),"0"<=f&&"9">=f);l++);if("."==b.charAt(l)){for(g=++l;g<c&&(f=b.charAt(g),"0"<=f&&"9">=f);g++);g==l&&p();l=g}f=b.charAt(l);if("e"==f||"E"==f){f=b.charAt(++l);"+"!=f&&"-"!=f||l++;for(g=l;g<c&&(f=b.charAt(g),"0"<=f&&"9">=f);g++);g==l&&p();l=g}return+b.slice(k,
l)}n&&p();if("true"==b.slice(l,l+4))return l+=4,d;if("false"==b.slice(l,l+5))return l+=5,!1;if("null"==b.slice(l,l+4))return l+=4,e}p()}return"$"},n=function(b){var c,e;"$"==b&&p();if("string"==typeof b){if("@"==b.charAt(0))return b.slice(1);if("["==b){for(c=[];;e||(e=d)){b=m();if("]"==b)break;e&&(","==b?(b=m(),"]"==b&&p()):p());","==b&&p();c.push(n(b))}return c}if("{"==b){for(c={};;e||(e=d)){b=m();if("}"==b)break;e&&(","==b?(b=m(),"}"==b&&p()):p());","!=b&&"string"==typeof b&&"@"==b.charAt(0)&&":"==
m()||p();c[b.slice(1)]=n(m())}return c}p()}return b},v=function(d,c,e){e=y(d,c,e);e===b?delete d[c]:d[c]=e},y=function(b,d,c){var e=b[d],p;if("object"==typeof e&&e)if("[object Array]"==f.call(e))for(p=e.length;p--;)v(e,p,c);else g(e,function(b){v(e,b,c)});return c.call(b,d,e)},k.parse=function(b,d){var c,k;l=0;B=b;c=n(m());"$"!=m()&&p();l=B=e;return d&&"[object Function]"==f.call(d)?y((k={},k[""]=c,k),"",d):c}));s&&define(function(){return k})})();window.appstorm=window.a=function(){var c=document.getElementById("a-core"),b={url:"",contains:function(b,c){if(b instanceof Array)for(var f=b.length;f--;){if(b[f]===c)return!0}else if(this.isObject(b))return c in b;return!1},clone:function(b){if(a.isObject(b)){if(a.isArray(b))for(var c=b.length,f=Array(c),h=0;h<c;++h)f[h]=a.clone(b[h]);else for(c in f={},a.isFunction(b.constructor)&&(f=new b.constructor),a.isObject(b.prototype)&&(f.prototype=b.prototype),b)f[c]=a.clone(b[c]);return f}return b},isNumber:function(b){return!isNaN(parseFloat(b))&&
isFinite(b)},isObject:function(b){return"object"===typeof b&&null!==b},isString:function(b){return"string"===typeof b},isFunction:function(b){return"function"===typeof b},isNull:function(b){return"undefined"===typeof b||null===b},isBoolean:function(b){return"boolean"===typeof b},isArray:function(b){return b instanceof Array}};c&&"undefined"!==typeof c.src&&(b.url=c.src.replace(/\/[^/]*$/,"/"));return b}();
a.console=function(){function c(c,e,f,h){a.isArray(b[c])||(c="log");b[c].push(e);if(!a.isNull(window.console)&&a.isFunction(window.console.log)&&!1!==h)switch(a.environment.get("console")){case "error":if("error"!==c)break;case "warning":case "warn":if("warn"!==c&&"error"!==c)break;case "info":if("log"===c)break;default:h=!0;var g=!1;if(a.isString(e)&&0<=e.indexOf(":"))for(var s=e.substr(0,e.indexOf(":")).split("."),k=s.length;k--;){var x="verbose-"+s.join("."),x=a.environment.get(x);if(!a.isNull(x)){g=
!0;h=x<f?!1:!0;break}s.pop()}g||(a.isNull(a.environment.get("verbose"))||a.isNull(f))||parseInt(a.environment.get("verbose"),10)<f&&(h=!1);if(h)window.console[c](e)}for(;2E3<b[c].length;)b[c].shift()}var b={log:[],warn:[],info:[],error:[]};return{log:function(b,e,f){c("log",b,e,f)},warn:function(b,e,f){c("warn",b,e,f)},info:function(b,e,f){c("info",b,e,f)},error:function(b,e,f){c("error",b,e,f)},trace:function(c){return a.isString(c)&&c in b?b[c]:b},clear:function(){b={log:[],warn:[],info:[],error:[]}}}}();
a.parser={json:{stringify:function(c){try{return JSON.stringify(c)}catch(b){return a.console.error("a.parser.json.stringify : unable to stringify the value : "+c,1),""}},parse:function(c){try{return JSON.parse(c)}catch(b){return a.console.error("a.parser.json.parse : unable to parse the value : "+c,1),null}}},xml:{stringify:function(c){if(!a.isNull(c)&&!a.isNull(c.xml))return c.xml;if(!a.isNull(window.XMLSerializer))try{return(new window.XMLSerializer).serializeToString(c)}catch(b){return a.console.error("a.parser.xml.stringify : unable to stringify the value : "+
c,1),""}a.console.error("a.parser.xml.stringify : unable to find any parser available",1);return""},parse:function(c){if(!a.isNull(window.ActiveXObject)){for(var b=null,d=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0"],e=0,f=d.length;e<f;++e)try{b=new ActiveXObject(d[e])}catch(h){}b.async=!1;b.loadXML(c);return 0!=b.parseError.errorCode?(a.console.error("a.parser.xml.parse : error while parsing content : "+b.parseError.reason,1),null):b}if(!a.isNull(window.DOMParser))return(new DOMParser).parseFromString(c,
"text/xml");a.console.error("a.parser.xml.parse : unable to find any parser available",1);return null}}};
a.eventEmitter=function(){function c(c){for(var e in b.__list)1>b.__list[e].length&&delete b.__list[e]}var b=function(){this.__list={};this.__base="a.message"};b.prototype.setName=function(b){this.__base=""+b};b.prototype.addListener=function(b,c){a.isFunction(c)?(a.isNull(this.__list[b])&&(this.__list[b]=[]),this.__list[b].push(c),this.dispatch(this.__base+".add",{type:b,fct:c})):a.console.warn(this.__base+".addListener : unable to bind function, this is not a function",1)};b.prototype.removeListener=
function(b,e){if(!a.isNull(this.__list[b])){var f=this.__list[b].length;if(a.isFunction(e))for(;f--;)this.__list[b][f]===e&&this.__list[b].splice(f,1);this.dispatch(this.__base+".remove",{type:b,fct:e});c(b)}};b.prototype.removeAllListeners=function(b){a.isNull(this.__list[b])||(this.__list[b]=[],c(b))};b.prototype.clear=function(){var b=this.__base+".clear",c;for(c in this.__list)c!==b&&delete this.__list[c];this.dispatch(b,{})};b.prototype.dispatch=function(b,c){var f=this.__list[b];if(!a.isNull(f))for(var h=
0,g=f.length;h<g;++h)(function(b){setTimeout(function(){b(c)},0)})(f[h])};return b}();a.message=new a.eventEmitter;a.message.setName=function(){};
a.environment=function(){var c={verbose:2,console:"log"};return{get:function(b){return b in c?c[b]:null},set:function(b,d){a.isNull(b)||(a.console.log("a.environment.set: add item (key: "+b+", value: "+d+")",3),c[b]=d,a.message.dispatch("a.environment.add",{key:b,value:d}))},remove:function(b){a.isNull(c[b])||(a.console.log("a.environment.remove: remove item (key: "+b+")",3),delete c[b],a.message.dispatch("a.environment.remove",{key:b}))},clear:function(){c={verbose:2,console:"log"}}}}();
a.ajax=function(c,b,d){this.params={url:"",method:"GET",type:"raw",async:!0,cache:!1,data:{},header:{}};this.success=a.isFunction(b)?b:function(){};this.error=a.isFunction(d)?d:function(){};for(var e in this.params)e in c&&typeof c[e]===typeof this.params[e]&&(this.params[e]=c[e]);a.isString(c.data)&&(this.params.data=c.data);this.request=null;if(a.isNull(window.XMLHttpRequest)){c=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(var f in c)try{this.request=new ActiveXObject(c[f])}catch(h){}}else this.request=
new XMLHttpRequest};a.ajax.prototype.parseResult=function(c,b){var d=c.type.toLowerCase();return"json"===d?a.parser.json.parse(b.responseText):"xml"===d?b.responseXML:b.responseText};
a.ajax.prototype.send=function(){var c=this.params.method.toUpperCase();if(!1===this.params.cache){var b=Math.floor(1E5*Math.random())+1;try{this.params.data.cachedisable=b}catch(d){}}b="";if(a.isString(this.params.data))b=this.params.data;else{for(var e in this.params.data)b+=encodeURIComponent(e)+"="+encodeURIComponent(this.params.data[e])+"&";b=b.slice(0,-1)}var f=this.params.url;e=this.params.async;"GET"===c&&""!==b&&(f+="?"+b);if(!0===e){var h={success:this.success,params:this.params,error:this.error,
request:this.request,parseResult:this.parseResult};this.request.onreadystatechange=function(){if(4===h.request.readyState){var b=200<=h.request.status&&300>h.request.status;b?h.success(h.parseResult(h.params,h.request),h.request.status):h.error(f,h.request.status);a.message.dispatch("a.ajax",{success:b,status:h.request.status,url:h.params.url,method:h.method,params:h.params})}}}this.request.open(c,f,e);"POST"===c&&this.request.setRequestHeader("Content-type","application/x-www-form-urlencoded");for(var g in this.params.header)this.request.setRequestHeader(g,
this.params.header[g]);this.request.send(b);return!1===e?this.parseResult(this.params,this.request):"No return in async mode"};
a.timer=function(){var c={};setInterval(function(){a.message.dispatch("a.timer.tick",{});for(var b in c){var d=c[b];d.current+=50;if(d.current>=d.timeout&&(d.current=0,a.isFunction(d.fct))){var e=a.isObject(d.scope)?d.scope:null;d.fct.call(e,null)}}},50);return{add:function(b,d,e){var f;for(f=Math.floor(1E6*Math.random());!a.isNull(c[f]);)f=Math.floor(1E6*Math.random());if(!a.isNumber(e)||0>=e)e=1E3,a.console.error("The timeout has not been setted properly into timer, timeout has been setted to 1000ms",
1);c[f]={fct:b,scope:d,timeout:e,current:0};return f},once:function(b,c,e){var f=this.add(function(){a.isFunction(b)&&b.call(this,null);a.timer.remove(f)},c,e);return f},get:function(b){b=c[b];return a.isNull(b)?null:b},remove:function(b){return a.isNull(c[b])?!1:(delete c[b],!0)},clear:function(){c={}}}}();
a.loader=function(){function c(b,c){if(a.isNull(b))return!1;for(var d=0,f=e.length;d<f;++d)if(e[d]===b)return a.isFunction(c)&&c(),!0;return!1}function b(b,c,d,h,t,r){for(var w in c)b.setAttribute(w,c[w]);!a.isNull(t)&&t.id&&b.setAttribute("id",t.id);var u=!1,q=function(c){u||(u=!0,a.isFunction(d)&&d(b),(a.isNull(t)||!1!==t.cache)&&e.push(h))};b.addEventListener?b.addEventListener("load",q,!1):b.readyState?b.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||q()}:
b.onload=q;if("text/css"===c.type){var p=document.styleSheets.length;f++;var m=a.timer.add(function(){document.styleSheets.length>p+f-1&&(f--,a.timer.remove(m),q())},null,50)}document.getElementsByTagName("head")[0].appendChild(b)}function d(b,c,d,f){var t={url:b,method:"GET",type:"raw",async:!0,cache:!0,data:{},header:{}};a.console.log("a.loader: load resource (url: "+b+")",3);a.isNull(d)||(a.contains(h,d.method)&&(t.method=d.method),a.isNull(d.type)||"json"!==d.type&&"xml"!==d.type||(t.type=d.type),
a.isObject(d.data)&&(t.data=d.data),a.isObject(d.header)&&(t.header=d.header),a.isBoolean(d.cache)&&(t.cache=d.cache));f=a.isFunction(f)?f:function(){};(new a.ajax(t,function(f,h){a.isFunction(c)&&c(f,h);(a.isNull(d)||!1!==d.cache)&&e.push(b)},f)).send()}var e=[],f=0,h="GET POST PUT DELETE HEAD OPTIONS".split(" ");return{js:function(b,d,e,f){c(b,d)||this.jsonp(b,d,e,f)},jsonp:function(c,d,e,f){var h=a.isObject(e)&&e.type?e.type:"text/javascript";a.console.log("a.loader: load resource (url: "+c+")",
3);b(document.createElement("script"),{type:h,src:c},d,c,e,f)},json:function(b,c,e,f){a.isObject(e)||(e={});e.type="json";a.isObject(e.header)||(e.header={});e.header.accept="application/json, text/javascript";d(b,c,e,f)},xml:function(b,c,e,f){a.isObject(e)||(e={});e.type="xml";a.isObject(e.header)||(e.header={});e.header.accept="application/xml, text/xml";d(b,c,e,f)},css:function(d,e,f,h){c(d,e)||(a.console.log("a.loader: load resource (url: "+d+")",3),b(document.createElement("link"),{rel:"stylesheet",
type:"text/css",href:d},e,d,f,h))},html:function(b,e,f,h){c(b,e)||(a.isObject(f)||(f={}),f.type="raw",!0===a.environment.get("debug")&&(f.cache=!1),a.isObject(f.header)||(f.header={}),f.header.accept="text/html",d(b,e,f,h))},javafx:function(b,d,e,f){if(a.isNull(e)||a.isNull(e.code)||a.isNull(e.id))a.console.warn("a.loader.javafx : the system need args.code and args.name setted to be able to load any javafx resource... This uri will not be loaded : "+b,3);else if(!c(b,d)){this.js("http://dl.javafx.com/"+
(e.version?e.version:"1.3")+"/dtfx.js",function(){javafx({archive:b,width:e.width||1,height:e.height||1,code:e.code,name:e.id})});var h=null,r=2E3,h=a.timer.add(function(){0<r--&&!a.isNull(document.getElementById(e.id).Packages)?(a.timer.remove(h),a.isFunction(d)&&d()):0>=r&&a.isFunction(f)&&f(b,408)},null,200)}},flash:function(b,d,e,f){a.isNull(e)||a.isNull(e.rootId)||a.isNull(e.id)?a.console.warn("a.loader.flash : the system need args parameters : rootId, id, setted to be able to load any flash resource... This uri will not be loaded : "+
b,3):c(b,d)||this.js(a.url+"vendor/storage/flash/swfobject.js",function(){swfobject.embedSWF(b,e.rootId,"100%","100%","10.0.0",a.url+"vendor/storage/flash/expressInstall.swf",e.flashvars,e.params,{id:e.id},function(c){!1===c.success&&a.isFunction(f)?f(b,408):!0===c.success&&a.isFunction(d)&&setTimeout(d,500)})})},silverlight:function(b,d,e,f){if(a.isNull(e)||a.isNull(e.rootId)||a.isNull(e.id))a.console.warn("a.loader.silverlight : the system need args parameters : rootId, id, setted to be able to load any silverlight resource... This uri will not be loaded : "+
b,3);else if(!c(b,d)){a.console.log("a.loader: load resource (url: "+b+")",3);var h=document.createElement("object");h.id=e.id;h.data="data:application/x-silverlight-2,";h.type="application/x-silverlight-2";a.isArray(e.params)||(e.params=[]);e.params.push({name:"source",value:b});for(var r=0,w=e.params.length;r<w;++r){var u=document.createElement("param");u.name=e.params[r].name;u.value=e.params[r].value;h.appendChild(u)}document.getElementById(e.rootId).appendChild(h);var q=null,p=2E3,q=a.timer.add(function(){0<
p--&&!a.isNull(document.getElementById(e.id).Content)?(a.timer.remove(q),d()):0>=p&&a.isFunction(f)&&f(b,408)},null,200)}},trace:function(){return e}}}();a.callback={};
a.callback.synchronizer=function(){function c(){s--;0>=s&&!1===r?(t=!1,u.prototype.dispatch("a.callback.synchronizer.success",{}),k(w)):0>=s&&(t=r=!1)}function b(){!0===t&&(r=!0,t=!1,u.prototype.dispatch("a.callback.synchronizer.error",{}),x.apply(this,arguments))}function d(b,c){w[b]=c}function e(b){a.isObject(b)&&(w=b)}function f(b){return a.isNull(w[b])?null:w[b]}function h(){return w}var g=[],s=0,k=function(){return!0},x=function(){return!0},t=!1,r=!1,w={},u=function(){};u.prototype=new a.eventEmitter;
u.prototype.constructor=this;u.prototype.setSuccess=function(b){k=a.isFunction(b)?b:k};u.prototype.setDone=u.prototype.setSuccess;u.prototype.setFail=function(b){x=a.isFunction(b)?b:x};u.prototype.setError=u.prototype.setFail;u.prototype.addCallback=function(){for(var p=[],p=!a.isNull(arguments[0])&&a.isArray(arguments[0])?arguments[0]:arguments,m=0,n=p.length;m<n;++m){var q=p[m];a.isFunction(q)&&(s++,g.push(q),!0===t&&q({success:c,done:c,getData:f,getFullData:h,setData:d,setFullData:e,fail:b,error:b}))}!0===
t&&a.console.warn("a.callback.synchronizer.addCallback : you should not add/remove callback when synchronizer is running",1)};u.prototype.removeCallback=function(b){for(var c=g.length-1;0<=c;--c)g[c]===b&&(!0===t&&a.console.warn("a.callback.synchronizer.removeCallback : you should not add/remove callback when synchronizer is running",1),s--,g.splice(c,1))};u.prototype.start=function(p,m){if(0>=s)c();else{t=!0;w={};for(var n=0,q=g.length;n<q;++n)g[n]({success:c,done:c,getData:f,getFullData:h,setData:d,
setFullData:e,fail:b,error:b},m);a.isNumber(p)&&0<p?setTimeout(function(){var c=parseInt(p,10);u.prototype.dispatch("a.callback.synchronizer.error",{timeout:c});b({timeout:c})},p):u.prototype.dispatch("a.callback.synchronizer.start",{timeout:-1})}};u.prototype.isRunning=function(){return t};var q=new u;q.setName("a.callback.synchronizer");return q};
a.callback.chainer=function(){function c(){0==x.length?(x=[],s(t),r.prototype.dispatch("a.callback.chainer.success",{})):r.prototype.start(arguments)}function b(){x=[];k.apply(this,arguments);r.prototype.dispatch("a.callback.chainer.error",{})}function d(b,c){t[b]=c}function e(b){a.isObject(b)&&(t=b)}function f(b){return a.isNull(t[b])?null:t[b]}function h(){return t}var g=[],s=function(){return!0},k=function(){return!0},x=[],t={},r=function(){};r.prototype=new a.eventEmitter;r.prototype.constructor=
this;r.prototype.setSuccess=function(b){s=a.isFunction(b)?b:s};r.prototype.setDone=r.prototype.setSuccess;r.prototype.setFail=function(b){k=a.isFunction(b)?b:k};r.prototype.setError=r.prototype.setFail;r.prototype.addCallback=function(){for(var b=[],b=!a.isNull(arguments[0])&&a.isArray(arguments[0])?arguments[0]:arguments,c=0,d=b.length;c<d;++c){var e=b[c];a.isFunction(e)&&(g.push(e),!0===r.prototype.isRunning()&&x.push(e))}!0===r.prototype.isRunning()&&a.console.warn("a.synchronizer.addCallback : you should not add/remove callback when synchronizer is running",
1)};r.prototype.removeCallback=function(b){for(var c=g.length-1;0<=c;--c)if(g[c]===b){if(!0===r.prototype.isRunning()){for(var d=x.length-1;0<=d;--d)x[d]===b&&x.splice(d,1);a.console.warn("a.synchronizer.removeCallback : you should not add/remove callback when synchronizer is running",1)}g.splice(c,1)}};r.prototype.start=function(){if(0==x.length){for(var k=0,q=g.length;k<q;++k)x.push(g[k]);r.prototype.dispatch("a.callback.chainer.start",{});t={};0==x.length&&c()}k=x.shift();a.isFunction(k)&&k({success:c,
done:c,getData:f,getFullData:h,setData:d,setFullData:e,fail:b,error:b},arguments)};r.prototype.isRunning=function(){return 0==x.length?!1:!0};var w=new r;w.setName("a.callback.chainer");return w};a.form=function(){function c(b,c){return a.isNull(b.getAttribute)?null:b.getAttribute(c)}function b(b){for(var c=[],d=b.length;d--;)c.push(b[d]);return c}function d(b){var d=c(b,"name");if(a.isNull(d)||""===d)if(d=c(b,"id"),a.isNull(d)||""===d)d=c(b,"class");return d}function e(d){var e=d.getElementsByTagName("input"),f=d.getElementsByTagName("textarea");d=d.getElementsByTagName("select");for(var e=b(e),h=e.length;h--;)a.contains(k,c(e[h],"type"))||e.splice(h,1);return e.concat(b(f),b(d))}function f(b,
d,e,f){var h="";a.isNull(e)||""===e||(h=c(b,"data-error-"+e));if(a.isNull(h)||""===h)h=c(b,"data-error");(a.isNull(h)||""===h)&&a.console.warn("A data-error tag has not been setted for "+d+" with value "+f+", can't proceed error show",3);a.isNull(a.language)||(h=a.language.getSingleTranslation(h,{name:e,value:f}));return{el:b,id:d,error:h}}var h="text search url tel email password".split(" "),g="number range date datetime datetime-local month time week".split(" "),s=h.concat(g,["number","checkbox",
"radio","file"]),k=g.concat(h,["color","checkbox","file","hidden","radio"]);return{skipNoValidate:!1,get:function(b){b=e(b);for(var f={},h=b.length;h--;){var g=b[h],k=d(g),q;q=g;var p=c(q,"type"),m=q.tagName.toLowerCase();q="input"===m||"textarea"===m?"checkbox"===p?q.checked:q.value:"select"===m?q.options[q.selectedIndex].value:void 0;null!==k&&""!==k&&(a.isNull(g)||"radio"!==c(g,"type")?f[k]=""===q?null:q:g.checked&&(f[k]=""===q?null:q))}a.console.log("a.form.get: found element list:",3);a.console.log(f,
3);return f},validate:function(b){if(!a.isNull(c(b,"novalidate"))&&!1===this.skipNoValidate)return[];b=e(b);for(var k=[],r="number range text search url email password color checkbox hidden radio".split(" "),w=RegExp("^[a-z]{2,}:\\/\\/([a-z0-9\\/\\.\\-_~+;:&=]{2,})$","gi"),u=RegExp("^.{2,}@.*\\.[a-z0-9]{2,}$","gi"),q=RegExp("^#([a-f]{3}|[a-f]{6})$","gi"),p=b.length;p--;){var m=b[p],n=m.tagName.toLowerCase();if("select"!==n&&a.isNull(c(m,"formnovalidate"))){var y=c(m,"type"),v=d(m),l=m.value,B=c(m,
"required"),A=c(m,"pattern");c(m,"multiple");var E=c(m,"min"),F=c(m,"max"),z=c(m,"step"),E=a.isNull(E)||""===E?null:parseFloat(E),F=a.isNull(F)||""===F?null:parseFloat(F),z=a.isNull(z)||""===z?null:parseFloat(z);"input"!==n||a.contains(r,y)?"number"!==y&&"range"!==y||a.isNumber(l)?"url"!==y||w.test(l)?"email"!==y||u.test(l)?"color"!==y||q.test(l)?null!==B&&a.contains(s,y)&&(""===l||a.isNull(l))?k.push(f(m,v,"required",l)):null===A||"textarea"!==n&&!a.contains(h,y)||RegExp(A).test(l)?null===E&&null==
F&&null==z||!a.contains(g,y)||(n=parseFloat(l),null!==E&&n<E?k.push(f(m,v,"min",l)):null!==F&&n>F?k.push(f(m,v,"max",l)):null!==z&&0!==n%z&&k.push(f(m,v,"step",l))):k.push(f(m,v,"pattern",l)):k.push(f(m,v,null,l)):k.push(f(m,v,null,l)):k.push(f(m,v,null,l)):k.push(f(m,v,null,l)):a.console.warn("Type "+y+" for input "+v+" not recognized or not supported",3)}}a.console.log("a.form.validate: found error list:",3);a.console.log(k,3);return k},validateAndGet:function(b){var c={};c.errorList=this.validate(b);
c.error=0<c.errorList.length?!0:!1;c.contentList=this.get(b);return c}}}();a.keyboard=function(c){return a.isNull(c)?(a.console.error("a.keyboard.global: error, Mousetrap is undefined, the plugin a.keyboard will not work",1),{addListener:function(){},removeListener:function(){},reset:function(){},clear:function(){}}):{addListener:function(b,d){a.console.log("a.keyboard.addListener: bind key: "+b,3);c.bind(b,d)},removeListener:function(b){a.console.log("a.keyboard.removeLister: remove listener on key: "+b,3);c.unbind(b)},reset:function(){a.console.log("a.keyboard.reset: clear all keys",
3);c.reset()},clear:function(){a.console.log("a.keyboard.clear: clear all keys",3);c.reset()}}}(window.Mousetrap);a.language=function(){function c(b,c){if(a.isNull(s[b]))return null;var d=s[b][c];if(a.isNull(d))a.console.info("a.language.__getRawTranslate: unable to find hash in dictionnary (value: "+c+", language: "+b+")",3);else return d;return null}function b(b){b=""+b;0>b.indexOf("{{")&&(b="{{"+b+"}}");b=b.replace("{{","\\{\\{");return b=b.replace("}}","\\}\\}")}function d(d,e){var f=c(h,d);if(!a.isNull(f)){var n=f;if(a.isArray(e))for(var g=0,k=e.length;g<k;++g)var l=b(g+1),l=RegExp(l,"gi"),n=n.replace(l,
e[g]);else for(g in e)l=b(g),l=RegExp(l,"gi"),n=n.replace(l,e[g]);if(0<=n.indexOf("{{")&&0<=n.indexOf("}}"))for(f=f.match(/\{\{[a-z0-9\-_]+\}\}/gi)||[],g=0,k=f.length;g<k;++g){var l=b(f[g]),r=f[g].replace("{{","").replace("}}",""),r=a.isNull(t[r])?null:t[r];a.isNull(r)||(l=RegExp(l,"gi"),n=n.replace(l,r))}return n=n.replace(/\{\{[a-z\-_0-9]+\}\}/gi,"")}return d}function e(b,c){a.isString(c)||(c=k);try{return b.getAttribute(c)}catch(d){return null}}function f(b){a.isNull(b)&&(b=document);var f=[];
a.isNull(e(b))||f.push(b);var m=[];b.querySelectorAll?(m=b.querySelectorAll("*["+k+"]"),0===m.length&&(m=b.querySelectorAll("*"))):m=b.getElementsByTagName("*");b=0;for(var n=m.length;b<n;++b)a.isNull(e(m[b]))||f.push(m[b]);m=0;for(b=f.length;m<b;++m){var n=f[m],g=e(n);if(!a.isNull(g)){var v=c(h,g),l={};a.isNull(v)&&(v=g);for(var v=v.match(/\{\{[a-z0-9\-_]+\}\}/gi)||[],r=0,s=v.length;r<s;++r){var w=v[r].replace("{{","").replace("}}",""),u=e(n,k+"-"+w);a.isNull(u)?(u="undefined"===t[w]?null:t[w],a.isNull(u)||
(l[w]=u)):l[w]=u}v=d(g,l);g=e(n,x);if(!a.isNull(g))try{n[g]=v}catch(z){}else if(n)if("INPUT"!==n.nodeName||"submit"!==n.type&&"reset"!==n.type)if("INPUT"===n.nodeName)try{n.placeholder=v}catch(C){}else if("FIELDSET"===n.nodeName)n.title=v;else if(!a.isNull(n.text)&&document.all)n.text=v;else if(a.isNull(n.childNodes))n.innerHTML=v;else{for(;0<n.childNodes.length;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(v))}else n.value=v}}}var h="en",g=["en","fr","de","sp"],s={},k="data-tr",
x="data-tr-attr",t={},r=!a.isNull(a.storage)&&!0===a.storage.persistent.support;if(r){var w=a.storage.persistent.getItem("a_language_store_language"),u=a.storage.persistent.getItem("a_language_store_allowed");a.isString(w)&&(h=w,f(document));a.isArray(u)&&(g=u)}return{getCurrent:function(){return h},setCurrent:function(b,c){!a.isString(b)||0>=b.length?a.console.error("a.language.setCurrent: setting a non-string lang, or empty string, as default language: "+b,1):(a.isNull(c)&&(c=!0),a.contains(g,b)||
a.console.warn("a.language.setCurrent: unable to find language in available language list (value: "+b+", available: "+g.join(";")+")",2),h=b,a.isNull(s[h])&&(s[h]={}),a.console.log("a.language.setCurrent: set current language to "+h+", request update ? "+c,3),a.message.dispatch("a.language.change",{value:h}),r&&a.storage.persistent.setItem("a_language_store_language",h),this.translate(document,c))},getAllowed:function(){return g},setAllowed:function(b){a.isString(b)&&(b=[b]);if(a.isArray(b)){g=b;
var c=0;for(b=b.length;c<b;++c)a.isNull(s[c])&&(s[c]={});r&&(a.console.log("a.language.setAllowed: set allowed language to "+g,3),a.storage.persistent.setItem("a_language_store_allowed",g))}else a.console.error("a.language.setAllowed: the allowed language must be an Array (value: "+b+")",1)},getSingleTranslation:function(b,c){return d(b,c)},addSingleTranslation:function(b,c,d,e){a.isNull(s[b])&&(a.console.warn("a.language.addSingleTranslation: be carefull, the language you submit does not seems to exist in dict (value: "+
b+", dict: "+g.join(";")+")",1),s[b]={});s[b][c]=d;this.translate(document,e)},addTranslation:function(b,c,d){a.isNull(s[b])&&(s[b]={});for(var e in c)s[b][e]=c[e];this.translate(document,d)},getTranslation:function(b){return a.isString(b)?s[b]:s},translate:function(b,c){!1!==c&&f(b)},addVariable:function(b,c){a.console.log("a.language.addVariable: add global variable (key: "+b+", value: "+c+")",3);t[b]=c},getVariable:function(b){return"undefined"===t[b]?null:t[b]},removeVariable:function(b){a.console.log("a.language.removeVariable: remove global variable (key: "+
b+")",3);delete t[b]},clear:function(){s={}}}}();a.page={};
a.page.template={__tmpl:{},get:function(c,b,d,e){var f=null;a.isObject(window.Mustache)?f=window.Mustache:a.isObject(window.Handlebars)&&(f=window.Handlebars);if(null==f)a.console.error("a.page.template.get: unable to find Mustache.JS or Handlebars.JS ! Can't proceed",1);else{var h=c.replace(/[^a-zA-Z0-9\\-]/g,"_"),g="a_tmpl_"+h+"_a",s=function(b,c,d){a.isFunction(b)&&(a.isNull(f.to_html)?(c=f.compile(a.page.template.__tmpl[c]),b(c(d))):b(f.to_html(a.page.template.__tmpl[c],d)))};a.isString(this.__tmpl[g])?(a.console.log("a.page.template.get: loading "+
g+" from cache",3),s(d,g,b)):document.getElementById(g)?(this.__tmpl[g]||(a.console.log("a.page.template.get: loading "+g+" from inner html page",3),this.__tmpl[g]=document.getElementById(g).innerHTML),s(d,g,b)):document.getElementById(h)?(this.__tmpl[h]||(a.console.log("a.page.template.get: loading "+h+" from inner html page",3),this.__tmpl[h]=document.getElementById(h).innerHTML),s(d,h,b)):(a.console.log("a.page.template.get: loading "+c+" from external resource",3),a.loader.html(c,function(c,e,
f){a.page.template.__tmpl[g]||(a.page.template.__tmpl[g]=c);s(d,g,b)},{},e))}},htmlToDom:function(c){var b=document.createElement("div");b.innerHTML=c.replace(/^\s+|\s+$/g,"");c=b.childNodes;for(var b=[],d=0,e=c.length;d<e;++d){var f=c.item(d);!a.isObject(f)||"1"!==f.nodeType.toString()&&"3"!==f.nodeType.toString()||b.push(f)}return b},remove:function(c,b){for(;c.firstChild;)c.removeChild(c.firstChild);a.isFunction(b)&&b()},append:function(c,b,d){var e=this.htmlToDom(b);if(a.isObject(e))for(var f=
0,h=e.length;f<h;++f)c.appendChild(e[f]);a.isNull(a.language)||a.language.translate(c);a.isFunction(d)&&d(b)},replace:function(c,b,d){this.remove(c);this.append(c,b,d)}};
a.page.event=function(){function c(b,c){a.isObject(c)||(c={});return function(){a.message.dispatch("a.page.event."+b,c)}}function b(){var b=(new Date).getTime();b>g+2*h&&(a.console.log("a.page.event.hibernate: hibernate mode has been detected",3),c("hibernate")());g=b}function d(b,c){window.addEventListener?window.addEventListener(b,c,!1):window.attachEvent&&window.attachEvent("on"+b,c)}function e(b){var d=window.location.hash?window.location.hash.substring(1):null;if(s!==d){if(!0!==b){for(k.push({hash:d,
time:(new Date).getTime()});1E3<k.length;)k.shift();a.console.log("a.page.event.hash: hash change (previous: "+s+", new: "+d+")",3);c("hash",{value:d,old:s})()}s=d}}var f={},h=1E4,g=(new Date).getTime(),s=null,k=[];f.hash={getHash:function(){return window.location.hash?window.location.hash.substring(1):null},getPreviousHash:function(){return s},setPreviousHash:function(b){a.console.log("a.page.event.hash.setPreviousHash: change previous hash to "+b,3);s=b},trace:function(){return k}};e(!0);!a.isNull(window.onhashchange)&&
(void 0===document.documentMode||7<document.documentMode)?window.onhashchange=e:setInterval(e,50);var x=["resize","load","unload"],t;for(t in x)d(x[t],c(x[t]));d("load",function(){setInterval(b,h)});return f}();a.state=function(){function c(b){return a.isArray(b)?b.reverse():a.isString(b)?[b]:[]}function b(){for(var b=u;u===b||0>=u;)u=Math.floor(1E5*Math.random());return u}function d(b,c){var d=[],e=b.length;c=a.isFunction(c)?c:function(){return!0};for(var f=0;f<e;++f){for(var h=!1,g=0;g<e;++g)if(f!=g&&b[f].id===b[g].id&&c(b[f])){h=!0;break}h||d.push(b[f].id)}return d}function e(b){for(var c=0,d=[],e=a.state.helper.tree.selectLevel(b,k,c);0<e.length;)d.push(e),c++,e=a.state.helper.tree.selectLevel(b,k,c);
return d}function f(b){b=h(b);for(var c=w.length,d=[];c--;){for(var e=w[c].hashtagList,f=e.length,g=!1;f--&&(g=b({hash:e[f]}),!0!==g););g||(d=d.concat(w[c].itemList.slice()),w.splice(c,1))}return d}function h(b){return function(c){if(a.isObject(c)&&0<c.hash.length){if(c.hash===b)return!0;if(0<=c.hash.indexOf("{{")&&0<=c.hash.indexOf("}}")){var d=a.state.helper.parameter.extract(c.hash);c=c.hash;for(var e=d.length;e--;)c=a.state.helper.parameter.replace(c,d[e]);return RegExp("^"+c+"$","gi").test(b)}}return!1}}
function g(b){return function(c){return a.isObject(c)&&(a.isArray(b)&&a.contains(b,c.id)||c.id===b)?!0:!1}}function s(b,c){var d=g(c),e=h(b);return function(b){return!0===d(b)||!0===e(b)?!0:!1}}function k(b){return a.isObject(b)&&a.isArray(b.children)?b.children:[]}function x(b){return a.isObject(b)?b.id:-1}function t(c){var g=a.clone(r),n=a.clone(r),y=a.clone(r),v=f(c.value),l=h(c.old),v=s(c.old,v),q=h(c.value);a.state.helper.tree.selectBranch(g,k,v);a.state.helper.tree.selectBranch(n,k,q);a.state.helper.tree.selectBranch(y,
k,h("*"));var v=a.state.helper.tree.flat(g.concat(n),k),t=d(v,function(b){return 0<=b.hash.indexOf("{{")&&0<=b.hash.indexOf("}}")&&!a.state.helper.tree.isInBranch(b,k,q)&&!a.state.helper.tree.isInBranch(b,k,l)?!1:!0}),u=a.state.helper.tree.flat(y,k,x),g=e(g),w=e(n);a.message.dispatch("a.state.begin",c);a.console.log("a.state: element allowed to proceed change: "+t+" (does not mean all of them will be loaded)",3);var z=b();a.state.helper.chainer("unload",g,t,-1,function(){a.state.helper.chainer("load",
w,t,z,function(){0<y.length?(y=[y],a.console.log("a.state: wildcard allowed to proceed change: "+u+" (does not mean all of them will be loaded)",3),a.state.helper.chainer("unload",y,u,-1,function(){a.state.helper.chainer("load",y,u,-1,function(){a.message.dispatch("a.state.end",c)})})):a.message.dispatch("a.state.end",c)})})}var r=[],w=[],u=-1,q=[];a.message.addListener("a.page.event.hash",t);a.message.addListener("a.message.clear",function(){a.message.addListener("a.page.event.hash",t)});return{clear:function(){r=
[]},tree:function(){return a.clone(r)},add:function(b,d){if(!a.isObject(b))return null;if(a.isArray(b))for(var e=0,f=b.length;e<f;++e)this.add(b[e]);else{b.hash=a.isString(b.hash)?b.hash:"";a.isObject(b.include)||(b.include={});b.include.css=c(b.include.css);b.include.js=c(b.include.js);b.include.translate=c(b.include.translate);b.include.html=a.isString(b.include.html)?b.include.html:null;for(var h=["preLoad","postLoad","preUnload","unload","postUnload"],l=0,e=h.length;l<e;++l)f=b[h[l]],a.isFunction(f)&&
(f=f.toString(),f=f.slice(f.indexOf("(")+1,f.indexOf(")")).match(/([^\s,]+)/g),a.isNull(f)&&a.console.warn("The result parameter for function '"+h[l]+"' in id '"+b.id+"' has not been found, the state may not work properly",2));!a.isArray(b.children)&&a.isObject(b.children)&&(b.children=[a.clone(b.children)]);l=!a.isNull(b.parent);e=a.isArray(b.children);"*"===b.hash&&(l&&a.console.warn("a.state.add : The wildcard has a parent setted (not allowed)",1),e&&a.console.warn("a.state.add : The wildcard has children (not allowed)",
1),b.parent=null,l=!1,b.children=[]);h=[];e&&(h=b.children.slice());b.children=[];a.isNull(b.id)&&(b.id=1);for(;!a.isNull(a.state.helper.tree.getItem(r,k,g(b.id)));)b.id=Math.floor(1E5*Math.random()+1);if(l){l=a.state.helper.tree.getItem(r,k,g(b.parent));if(a.isNull(l))return null;l.children.push(b)}else r.push(b);l=b.id;e=0;for(f=h.length;e<f;++e)a.isObject(h[e])&&(h[e].parent=l,this.add(h[e]));"*"===b.hash&&a.state.helper.chainer("load",[[b]],[l],-1,function(){});!0===b.bootOnLoad&&(h=a.clone(b),
h.data=h.converter=h.options=null,h.preLoad=h.load=h.postLoad=null,h.preUnload=h.unload=h.postUnload=null,d=a.isFunction(d)?d:function(){},a.state.helper.chainer("load",[[h]],[l],-1,d));return l}},getById:function(b){return a.state.helper.tree.getItem(r,k,g(b))},removeById:function(b){var c=a.state.helper.tree.getItem(r,k,g(b));a.console.log("a.state.removeById: remove element (id: "+b+")",3);a.state.helper.tree.selectBranch(r,k,function(b){return b===c?!1:!0})},loadById:function(b,f,n){var q=a.clone(r),
v=a.page.event.hash.getHash(),l=a.clone(r);a.state.helper.tree.selectBranch(q,k,g(b));a.state.helper.tree.selectBranch(l,k,h(v));var s=a.state.helper.tree.flat(q,k),l=a.state.helper.tree.flat(l,k),l=d(l.concat(s)),q=e(q);n=a.isFunction(n)?n:function(){};a.console.log("a.state.loadById: element allowed to proceed change: "+l+" (does not mean all of them will be loaded)",3);a.state.helper.chainer("load",q,l,-1,n);a.isNull(f)&&(f=v);b={id:b,itemList:a.state.helper.tree.flat(s,k,x),hashtagList:c(f)};
w.push(b)},unloadById:function(b,c){for(var d=this.getById(b),d=e([d]),f=[],h=w.length;h--;)f=f.concat(w[h].itemList);a.console.log("a.state.unloadById: element allowed to proceed change: "+f+" (does not mean all of them will be unloaded)",3);h=a.isFunction(c)?c:function(){};a.state.helper.chainer("unload",d,f,-1,h)},forceReloadById:function(c,d){for(var f=a.isFunction(d)?d:function(){},g=w.length,v=[],l=a.clone(w);g--;)a.contains(w[g].itemList,c)&&v.push(w[g].hashtagList);if(0<v.length)this.unloadById(c,
function(){for(var b=v.length;b--;)a.state.loadById(c,v[b]);w=l;f()});else{var g=a.clone(r),q=a.page.event.hash.getHash();a.state.helper.tree.selectBranch(g,k,h(q));for(var q=a.state.helper.tree.flat(g,k),s=q.length;s--;)if(q[s].id===c){var t=e([q[s]]),u=a.state.helper.tree.flat(g,k,x);a.console.log("a.state.forceReloadById: element allowed to proceed change: "+u+" (does not mean all of them will be loaded/unloaded)",3);var z=b();a.state.helper.chainer("unload",t,u,-1,function(){a.state.helper.chainer("load",
t,u,z,f)});break}}},hashExists:function(b){return a.isString(b)&&""!==b?a.state.helper.tree.isInBranch(r,k,h(b)):!1},__currentGeneratedId:function(){return u},type:{add:function(b,c){q[b]=c},get:function(b){return a.isFunction(q[b])?q[b]:null},list:function(){return q}},helper:{tree:{},chainer:{},parameter:{}}}}();
a.state.helper.tree={flat:function(c,b,d){var e=[];if(!a.isArray(c)||!a.isFunction(b))return[];d=a.isFunction(d)?d:function(b){return b};for(var f=0,h=c.length;f<h;++f){var g=this.flat(b(c[f]),b,d);e.push(d(c[f]));0<g.length&&(e=e.concat(g))}return e},getItem:function(c,b,d){if(!a.isArray(c)||!a.isFunction(d)||!a.isFunction(b))return null;for(var e=0,f=c.length;e<f;++e){if(!0===d(c[e]))return c[e];var h=this.getItem(b(c[e]),b,d);if(!a.isNull(h))return h}return null},isInBranch:function(c,b,d){c=this.getItem(c,
b,d);return a.isNull(c)?!1:!0},selectBranch:function(c,b,d){if(a.isArray(c)&&a.isFunction(b)&&a.isFunction(d))for(var e=c.length;e--;){var f=b(c[e]);!1===d(c[e])&&a.isNull(this.getItem(f,b,d))?c.splice(e,1):0<f.length&&this.selectBranch(f,b,d)}},selectLevel:function(c,b,d){if(!a.isArray(c)||!a.isFunction(b))return[];var e=[],f=c.length;if(a.isNull(d)||isNaN(d)||0>=d)return c;for(d--;f--;){var h=b(c[f]);0<h.length&&(e=e.concat(this.selectLevel(h,b,d)))}return e}};
a.state.helper.chainer=function(c,b,d,e,f){function h(b,c){var d={};a.isNull(b)||(d.resource=b);a.isNull(c)||(d.status=c);a.message.dispatch("a.state.error",d)}function g(b){return function(c){w(b,function(){c.done()})}}function s(b,c,d){return function(e){a.loader[b](c,function(b){a.isFunction(d)&&d(b);e.done()})}}function k(b,c,d){if(a.isObject(d))for(var e in d)d[e]=a.state.helper.parameter.extrapolate(d[e],b,c),k(b,c,d[e])}function x(b,c,d,e){var f=a.clone(d);d=a.page.event.hash.getHash();f.url=
a.state.helper.parameter.extrapolate(c,d,e);k(d,e,f);c=c.replace(/^\s+|\s+$/g,"");return 0===c.indexOf("{{")&&c.indexOf("}}")===c.length-2?(c=a.state.helper.parameter.extrapolate(c,d,e,!1),function(d){var e=d.getData("data")||{};a.isObject(e.a)||(e.a=e.appstorm={},e.a.parameter=e.appstorm.parameter={});a.isNull(b)?e=c:(e.a.parameter[b]=c,e.appstorm.parameter=e.a.parameter,a.isNull(e[b])&&(e[b]=c));d.setData("data",e);d.done()}):function(c){a.isNull(c.getData("data"))&&c.setData("data",{});(new a.ajax(f,
function(d){if(a.isNull(b))c.setData("data",d);else{var e=c.getData("data");e[b]=d;c.setData("data",e)}c.done()},h)).send()}}function t(b,c){for(var d=new a.callback.synchronizer,e=b.include.css,f=b.include.js,g=b.include.html,k=b.include.translate,p=b.data,q=b.title,r=b.options,t=b.converter,u=b.hash,w=e.length,D=f.length;w--;)d.addCallback(s("css",e[w]));for(;D--;)d.addCallback(s("js",f[D]));if(!a.isNull(a.language)&&0<k.length)for(e=k.length;e--;)d.addCallback(s("json",k[e],function(b){for(var c in b)a.language.addTranslation(c,
b[c],!0)}));a.isString(g)&&(g=a.state.helper.parameter.extrapolate(g,a.page.event.hash.getHash(),u),d.addCallback(function(b){b.setData("html",g);a.page.template.get(g,{},b.done,h)}));if(a.isString(p)||a.isObject(p))if(a.isObject(r)||(r={type:"json"}),a.isString(r.type)||(r.type="json"),a.isString(p))d.addCallback(x(null,p,r,u));else for(var G in p)a.isObject(p[G])&&a.isString(p[G].url)?(a.isObject(p[G].options)||(p[G].options={type:"json"}),d.addCallback(x(G,p[G].url,p[G].options,u))):d.addCallback(x(G,
p[G],r,u));else d.addCallback(function(b){b.setData("data",{});b.done()});d.setSuccess(function(b){a.isNull(t)||t(b.data);a.isNull(q)||(q=a.state.helper.parameter.extrapolate(q,a.page.event.hash.getHash(),u),a.isNull(a.language)?document.title=q:document.title=a.language.getSingleTranslation(q));var d=b.data,e=b.html,d=a.isNull(d)?{}:d;a.isNull(e)?a.isFunction(c)&&c(b,null):a.page.template.get(e,d,function(d){a.isFunction(c)&&c(b,d)})});d.setFail(h);d.start()}function r(b,d){var f=new a.callback.chainer;
"unload"===c?f.addCallback(b.preUnload,b.unload,b.postUnload):f.addCallback(function(c){a.isFunction(b.preLoad)&&(-1==e||0<=e&&a.state.__currentGeneratedId()===e)?b.preLoad(c):c.done()},function(c){t(b,function(d,f){a.isFunction(b.load)&&(-1==e||0<=e&&a.state.__currentGeneratedId()===e)&&b.load(f);var h=c.getFullData()||{};if(a.isObject(d.data))for(var g in d.data)h[g]=d.data[g];c.setFullData(h);c.done()})},function(c){a.isFunction(b.postLoad)&&(-1==e||0<=e&&a.state.__currentGeneratedId()===e)?b.postLoad(c):
c.done()});f.setSuccess(d);f.setFail(h);f.start()}function w(b,c){for(var e=new a.callback.synchronizer,f=b.length;f--;)a.contains(d,b[f].id)&&function(b){e.addCallback(function(c){r(b,function(){c.done()})})}(b[f]);e.setSuccess(c);e.setFail(h);e.start()}var u=b.length;c="unload"===c?"unload":"load";d=d||[];var q=new a.callback.chainer;if("unload"===c)for(;u--;)q.addCallback(g(b[u]));else for(var p=0;p<u;)q.addCallback(g(b[p])),p++;q.setSuccess(f);q.setFail(h);q.start()};
a.state.helper.parameter={extract:function(c,b){var d=/\{\{(\s*\w+\s*:\s*[a-z0-9_\-\[\]\(\)\^.\|\+\*\?\\\/]+\s*)\}\}/gmi,e=/^\s+|\s+$/g,f=!a.isNull(b);f&&(d=b);for(var h=[],g;g=d.exec(c);){var s=null,s=f?["hash",g[1]]:g[1].split(":",2);h.push({original:g[0].replace(e,""),name:s[0].replace(e,""),regex:s[1].replace(e,""),start:g.index})}return h},replace:function(c,b,d){d=a.isNull(d)?"("+b.regex+")":d;return c.substr(0,b.start)+d+c.substr(b.start+b.original.length)},extrapolate:function(c,b,d,e){if(a.isString(c)&&
0<=c.indexOf("{{")&&0<=c.indexOf("}}")){for(var f=this.extract(c),h=this.extract(d),g=this.extract(c,/\{\{(\s*\w+\s*)\}\}/gmi),f=f.concat(g),g=h.length;g--;)d=this.replace(d,h[g]);if(g=RegExp("^"+d+"$","gi").exec(b)){b=0;for(d=h.length;b<d;++b)h[b].value=g[b+1];for(var g=0,s=f.length;g<s;++g)for(b=0;b<d;++b)h[b].name===f[g].regex&&"hash"===f[g].name&&(f[g].value=h[b].value)}h=f.length;for(e=!1===e?function(b,c,d){return d}:this.replace;h--;){b=f[h];"hash"!==b.name&&"hashtag"!==b.name||a.isNull(b.value)||
(c=this.replace(c,b,b.value));d=!1;if(!a.isNull(a.storage))switch(b.name){case "temporary":c=e(c,b,a.storage.temporary.getItem(b.regex));d=!0;break;case "memory":c=e(c,b,a.storage.memory.getItem(b.regex));d=!0;break;case "persistent":c=e(c,b,a.storage.persistent.getItem(b.regex));d=!0;break;case "cookie":c=e(c,b,a.storage.cookie.getItem(b.regex));d=!0;break;case "store":case "storage":d=a.storage.temporary.getItem(b.regex),c=a.isNull(d)?e(c,b,a.storage.persistent.getItem(b.regex)):e(c,b,d),d=!0}if(!d&&
(d=a.state.type.list(),a.isObject(d)))for(var k in d)k===b.name&&(g=d[k],c=a.isFunction(g)?e(c,b,g(b.regex)):e(c,b,g))}}return c}};a.storage={__printGetItem:function(c,b,d){"__test_support"!==b&&a.console.log("a.storage.type."+c+".getItem: get element (key: "+b+", value: "+d+")",3)},__printGetErrorItem:function(c,b){"__test_support"!==b&&a.console.log("a.storage.type."+c+".getItem: unable to find key ("+b+") in store",2)},__printSetItem:function(c,b,d){"__test_support"!==b&&a.console.log("a.storage.type."+c+".setItem: add element (key: "+b+", value: "+d+")",3)},__printRemoveItem:function(c,b){"__test_support"!==b&&a.console.log("a.storage.type."+
c+".removeItem: remove element (key: "+b+")",3)},type:{}};
a.storage.type.cookie=function(){var c=!1,b={support:!1,engine:"cookie",setItem:function(b,c,f){var h="";a.storage.__printSetItem("cookie",b,c);f&&(h=new Date,h.setTime(h.getTime()+864E5*f),h="; expires="+h.toGMTString());document.cookie=b+"="+escape(a.parser.json.stringify(c))+h+"; path=/"},getItem:function(b){if(0<document.cookie.length){var c=document.cookie.indexOf(b+"=");if(-1!=c){var c=c+b.length+1,f=document.cookie.indexOf(";",c);-1==f&&(f=document.cookie.length);c=a.parser.json.parse(unescape(document.cookie.substring(c,
f)));a.storage.__printGetItem("cookie",b,c);return c}}a.storage.__printGetErrorItem("cookie",b);return null},removeItem:function(b){a.storage.__printRemoveItem("cookie",b);this.setItem(b,"",-1);c&&a.message.dispatch("a.storage.remove",{key:b})}};b.setItem("__test_support","ok");"ok"===b.getItem("__test_support")&&(b.removeItem("__test_support"),b.support=!0);c=!0;return b}();a.storage.cookie=a.storage.type.cookie;
a.storage.type.localStorage=function(){var c=!1;"localStorage"in window&&null!==window.localStorage&&(window.localStorage.setItem("__test_support","o"),"o"===window.localStorage.getItem("__test_support")&&(window.localStorage.removeItem("__test_support"),c=!0));return{support:c,engine:"localStorage",getItem:function(b){if(c){var d=window.localStorage.getItem(b);if(a.isNull(d))return a.storage.__printGetErrorItem("localStorage",b),null;d=a.parser.json.parse(d);a.storage.__printGetItem("localStorage",
b,d);return d}return null},setItem:function(b,d){c&&(a.storage.__printSetItem("localStorage",b,d),window.localStorage.setItem(b,a.parser.json.stringify(d)),a.message.dispatch("a.storage.add",{key:b,value:d}))},removeItem:function(b){c&&(a.storage.__printRemoveItem("localStorage",b),window.localStorage.removeItem(b),a.message.dispatch("a.storage.remove",{key:b}))}}}();
a.storage.type.globalStorage=function(){var c=!1,b=window.location.hostname;a.isNull(window.globalStorage)||(window.globalStorage[b].setItem("__test_support","ok"),"ok"==window.globalStorage[b].getItem("__test_support")&&(window.globalStorage[b].removeItem("__test_support"),c=!0));return{support:c,engine:"globalStorage",getItem:function(d){if(c){var e=window.globalStorage[b].getItem(d);if(a.isObject(e)&&!a.isNull(e.value))return e=a.parser.json.parse(e.value),a.storage.__printGetItem("globalStorage",
d,e),e;if(a.isNull(e))a.storage.__printGetErrorItem("globalStorage",d);else return e=a.parser.json.parse(e),a.storage.__printGetItem("globalStorage",d,e),e}return null},setItem:function(d,e){c&&(a.storage.__printSetItem("globalStorage",d,e),window.globalStorage[b].setItem(d,a.parser.json.stringify(e)),a.message.dispatch("a.storage.add",{key:d,value:e}))},removeItem:function(d){c&&(a.storage.__printRemoveItem("globalStorage",d),window.globalStorage[b].removeItem(d),a.message.dispatch("a.storage.remove",
{key:d}))}}}();
a.storage.type.memory=function(){var c={};return{support:!0,engine:"memory",getItem:function(b){var d=c[b];if(!a.isNull(d))return a.storage.__printGetItem("memory",b,d),a.console.log("a.storage.memory.getItem: found item (key: "+b+", value: "+d+")",3),d;a.storage.__printGetErrorItem("memory",b);return null},setItem:function(b,d){c[b]=d;a.storage.__printSetItem("memory",b,d);a.message.dispatch("a.storage.add",{key:b,value:d})},removeItem:function(b){a.storage.__printRemoveItem("memory",b);a.isNull(c[b])||
(delete c[b],a.message.dispatch("a.storage.remove",{key:b}))}}}();a.storage.memory=a.storage.type.memory;
a.storage.type.sessionStorage=function(){var c=!1;"sessionStorage"in window&&!a.isNull(window.sessionStorage)&&(window.sessionStorage.setItem("__test_support","o"),"o"===window.sessionStorage.getItem("__test_support")&&(window.sessionStorage.removeItem("__test_support"),c=!0));return{support:c,engine:"sessionStorage",getItem:function(b){if(c){var d=window.sessionStorage.getItem(b);if(a.isNull(d))return a.storage.__printGetErrorItem("sessionStorage",b),null;d=a.parser.json.parse(d);a.storage.__printGetItem("sessionStorage",
b,d);return d}return null},setItem:function(b,d){c&&(a.storage.__printSetItem("sessionStorage",b,d),window.sessionStorage.setItem(b,a.parser.json.stringify(d)),a.message.dispatch("a.storage.add",{key:b,value:d}))},removeItem:function(b){c&&(a.storage.__printRemoveItem("sessionStorage",b),window.sessionStorage.removeItem(b),a.message.dispatch("a.storage.remove",{key:b}))}}}();
a.storage.type.userData=function(){var c=!1;if(document.all)try{document.write('<input type="hidden" id="a_storage" style="display:none;behavior:url(\'#default#userData\')" />');var b=document.getElementById("a_storage");b.load("aUserDataStorage");b.setAttribute("__test_support","ok");b.save("aUserDataStorage");"ok"===b.getAttribute("__test_support")&&(b.removeAttribute("__test_support"),b.save("aUserDataStorage"),c=!0)}catch(d){c=!1}return{support:c,engine:"userData",getItem:function(d){if(c){var f=
a.parser.json.parse(b.getAttribute(d));if(a.isNull(f))return a.storage.__printGetErrorItem("userData",d),null;a.storage.__printGetItem("userData",d,f);return f}return null},setItem:function(d,f){c&&(a.storage.__printSetItem("userData",d,f),b.setAttribute(d,a.parser.json.stringify(f)),b.save("aUserDataStorage"),a.message.dispatch("a.storage.add",{key:d,value:f}))},removeItem:function(d){c&&(a.storage.__printRemoveItem("userData",d),b.removeAttribute(d),b.save("aUserDataStorage"),a.message.dispatch("a.storage.remove",
{key:d}))}}}();
a.storage.type.flash=function(){function c(c){if(!1===b&&!1===d){var h=document.createElement("div");h.id="flashstoragecontent";document.body.appendChild(h);var g={id:e,rootId:h.id,flashvars:{},params:{wmode:"transparent",menu:"false",scale:"noScale",allowFullscreen:"true",allowScriptAccess:"always"}};a.loader.flash(a.url+"vendor/storage/flash/localStorage.swf",function(e){d=!0;e=document.getElementById(g.id);!0===e.testData()&&(b=!0,e.setDatabase("a_flashStorage"));!0===b&&a.isFunction(c)&&c(b)},
g)}else!0===b&&a.isFunction(c)&&c(b)}var b=!1,d=!1,e="flashstorage";return{support:function(){return b},ready:function(){return d},engine:"flash",start:function(b){c(b)},getItem:function(c){this.start();if(!0===b){var d=document.getElementById(e).getData(c);if(a.isNull(d))return a.storage.__printGetErrorItem("flash",c),null;a.storage.__printGetItem("flash",c,d);return d}return null},setItem:function(c,d){this.start();!0===b&&(a.storage.__printSetItem("flash",c,d),document.getElementById(e).setData(c,
d))},removeItem:function(c){this.start();if(!0===b)return a.storage.__printRemoveItem("flash",c),document.getElementById(e).removeData(c)}}}();
a.storage.type.silverlight=function(){function c(c){if(!1===b&&!1===d){var h=document.createElement("div");h.id="__silverlightstorage";document.body.appendChild(h);var g={id:e,rootId:h.id,params:[{name:"minRuntimeVersion",value:"2.0.31005.0"},{name:"autoUpgrade",value:"true"}]};a.loader.silverlight(a.url+"vendor/storage/silverlight/silverlightStorage.xap",function(e){d=!0;!0===document.getElementById(g.id).Content.store.testData()&&(b=!0);!0===b&&a.isFunction(c)&&c(b)},g)}else!0===b&&a.isFunction(c)&&
c(b)}var b=!1,d=!1,e="silverlightstorage";return{support:function(){return b},ready:function(){return d},engine:"silverlight",start:function(b){c(b)},getItem:function(c){this.start();if(!0===b){var d=document.getElementById(e).Content.store.loadData(c);if(a.isNull(d)||"false"===d)return a.storage.__printGetErrorItem("silverlight",c),null;d=a.parser.json.parse(d);a.storage.__printGetItem("silverlight",c,d);return d}return null},setItem:function(c,d){this.start();!0===b&&(a.storage.__printSetItem("silverlight",
c,d),document.getElementById(e).Content.store.saveData(c,a.parser.json.stringify(d)))},removeItem:function(c){this.start();!0===b&&(a.storage.__printRemoveItem("silverlight",c),document.getElementById(e).Content.store.removeData(c))}}}();
a.storage.type.javafx=function(){function c(c){!1===b&&!1===d?a.loader.javafx(a.url+"vendor/storage/javafx/JavaFXStorage.jar",function(){d=!0;!0===document.getElementById("javafxstorage").Packages.javafxstorage.localStorage.testData()&&(b=!0,el.setDatabase("a_javafxStorage"));!0===b&&a.isFunction(c)&&c(b)},{code:"javafxstorage.Main",id:"javafxstorage"}):!0===b&&a.isFunction(c)&&c(b)}var b=!1,d=!1;return{support:function(){return b},ready:function(){return d},engine:"javafx",start:function(b){c(b)},
getItem:function(c){this.start();if(!0===b){var d=document.getElementById("javafxstorage").Packages.javafxstorage.localStorage.loadData(c);if(a.isNull(d)||"false"===d)return a.storage.__printGetErrorItem("javafx",c),null;d=a.parser.json.parse(d);a.storage.__printGetItem("javafx",c,d);return d}return null},setItem:function(c,d){this.start();!0===b&&(a.storage.__printSetItem("javafx",c,d),document.getElementById("javafxstorage").Packages.javafxstorage.localStorage.saveData(c,a.parser.json.stringify(d)))},
removeItem:function(c){this.start();!0===b&&(a.storage.__printRemoveItem("javafx",c),document.getElementById("javafxstorage").Packages.javafxstorage.localStorage.removeData(c))}}}();a.storage.temporary=function(){for(var c=["sessionStorage","cookie","memory"],b=0,d=c.length;b<d;++b){var e=c[b];if(a.storage.type[e].support)return a.console.log("a.storage.temporary: choosing storage "+a.storage.type[e].engine,3),a.message.dispatch("a.storage.temporary.change",{engine:e}),a.storage.type[e]}return null}();
a.storage.external=function(){function c(b,c){a.storage.external.ready=b.ready;a.storage.external.support=b.support;a.storage.external.engine=b.engine;a.storage.external.getItem=b.getItem;a.storage.external.setItem=b.setItem;a.storage.external.removeItem=b.removeItem;a.isFunction(c)&&c()}return{start:function(b){var d=a.storage.type.silverlight,e=a.storage.type.flash,f=a.storage.type.javafx;d.start(function(h){h?(a.console.log("a.storage.external: choosing storage silverlight",3),c(d,b)):e.start(function(d){d?
(a.console.log("a.storage.external: choosing storage flash",3),c(e,b)):f.start(function(d){d?(a.console.log("a.storage.external: choosing storage javafx",3),c(f,b)):a.console.warn("a.storage.external: choosing storage NONE AVAILABLE",3)})})})}}}();
a.storage.persistent=function(){for(var c=["localStorage","globalStorage","userData","cookie"],b=0,d=c.length;b<d;++b){var e=c[b];if(a.storage.type[e].support)return a.console.log("a.storage.persistent: choosing storage "+a.storage.type[e].engine,3),a.message.dispatch("a.storage.persistent.change",{engine:e}),a.storage.type[e]}return null}();
null==a.storage.persistent&&(a.storage.persistent={},a.storage.persistent.support=!1,a.storage.persistent.engine=function(){return"none"},a.storage.persistent.getItem=function(){return null},a.storage.persistent.setItem=function(){},a.storage.persistent.removeItem=function(){});a.storage.support=a.storage.persistent.support;a.storage.engine=a.storage.persistent.engine;a.storage.getItem=a.storage.persistent.getItem;a.storage.setItem=a.storage.persistent.setItem;a.storage.removeItem=a.storage.persistent.removeItem;
